Go语言入门教程，Golang入门教程（非常详细）

<http://c.biancheng.net/golang/>

<https://www.kancloud.cn/imdszxs/golang/1535582>

<https://www.xinbaoku.com/archive/2DHvuPFr.html>

# 目录
 

[第1章 Go语言简介 [5](#第1章-go语言简介)](\l)

[1.1 Go语言简介 [5](#go语言简介)](\l)

[Go语言创始人 [5](#go语言创始人)](\l)

[Go 是编译型语言 [6](#go-是编译型语言)](\l)

[为什么要学习Go语言 [6](#为什么要学习go语言)](\l)

[Go语言吉祥物 [7](#go语言吉祥物)](\l)

[1.2 Go语言的特性 [7](#go语言的特性)](\l)

[语法简单 [7](#语法简单)](\l)

[并发模型 [7](#并发模型)](\l)

[内存分配 [8](#内存分配)](\l)

[垃圾回收 [8](#垃圾回收)](\l)

[静态链接 [8](#静态链接)](\l)

[标准库 [8](#标准库)](\l)

[工具链 [9](#工具链)](\l)

[1.3 Go语言为并发而生 [9](#go语言为并发而生)](\l)

[1.4 哪些项目使用Go语言开发？ [12](#哪些项目使用go语言开发)](\l)

[1) Docker [12](#docker)](\l)

[2) Go语言 [12](#go语言)](\l)

[3) Kubernetes [13](#kubernetes)](\l)

[4) etcd [13](#etcd)](\l)

[5) beego [13](#beego)](\l)

[6) martini [13](#martini)](\l)

[7) codis [13](#codis)](\l)

[8) delve [13](#delve)](\l)

[1.5 哪些大公司正在使用Go语言 [14](#哪些大公司正在使用go语言)](\l)

[1.6 Go语言适合做什么 [15](#go语言适合做什么)](\l)

[1、服务器端开发 [15](#服务器端开发)](\l)

[2、服务器编程语言 [15](#服务器编程语言)](\l)

[3、网络编程 [15](#网络编程)](\l)

[4、内存数据库和云平台领域开发 [15](#内存数据库和云平台领域开发)](\l)

[拓展阅读 [16](#拓展阅读)](\l)

[1.7 Go语言和其它编程语言的对比 [17](#go语言和其它编程语言的对比)](\l)

[1.8 Go语言的性能如何？ [20](#go语言的性能如何)](\l)

[1.9 Go语言标准库强大 [21](#go语言标准库强大)](\l)

[1.10 Go语言上手简单 [22](#go语言上手简单)](\l)

[Go语言工程结构简单 [24](#go语言工程结构简单)](\l)

[Go语言编译速度快 [24](#go语言编译速度快)](\l)

[1.11 Go语言代码风格清晰、简单 [24](#go语言代码风格清晰简单)](\l)

[1) 去掉循环冗余括号 [24](#去掉循环冗余括号)](\l)

[2) 去掉表达式冗余括号 [25](#去掉表达式冗余括号)](\l)

[3) 强制的代码风格 [25](#强制的代码风格)](\l)

[4) 不再纠结于 i++ 和 ++i [25](#不再纠结于-i-和-i)](\l)

[1.12 Go语言是怎么完成编译的 [25](#go语言是怎么完成编译的)](\l)

[预备知识 [26](#预备知识)](\l)

[编译原理 [28](#编译原理)](\l)

[编译器入口 [29](#编译器入口)](\l)

[总结 [31](#总结)](\l)

[1.13 在Windows上安装Go语言开发包
[31](#在windows上安装go语言开发包)](\l)

[1.13.1下载Go语言开发包 [31](#下载go语言开发包)](\l)

[1.13.2安装Go语言开发包 [32](#安装go语言开发包)](\l)

[1.13.3设置环境变量 [35](#设置环境变量)](\l)

[1.13+1 Go语言(Golang)安装下载配置及debug调试
[37](#go语言golang安装下载配置及debug调试)](\l)

[1.14 在Linux上安装Go语言开发包 [38](#在linux上安装go语言开发包)](\l)

[1.14.1安装Go语言开发包 [39](#安装go语言开发包-1)](\l)

[1.14.2配置环境变量 [39](#配置环境变量)](\l)

[1.14.3验证安装 [40](#验证安装)](\l)

[1.14+1 Linux下 Go语言环境安装 [41](#linux下-go语言环境安装)](\l)

[1.15 在Mac OS上安装Go语言开发包 [42](#在mac-os上安装go语言开发包)](\l)

[1.15.1安装Go语言开发包 [42](#安装go语言开发包-2)](\l)

[1.15.2配置环境变量 [43](#配置环境变量-1)](\l)

[1.15.3验证安装 [44](#验证安装-1)](\l)

[1.16 Go语言集成开发环境 [44](#go语言集成开发环境)](\l)

[1.17 Go语言工程结构详述 [47](#go语言工程结构详述)](\l)

[1.17.1目录结构 [47](#目录结构)](\l)

[1.17.2源文件 [48](#源文件)](\l)

[1.18Go语言依赖管理 [48](#go语言依赖管理)](\l)

[1.18.1为什么需要依赖管理 [49](#为什么需要依赖管理)](\l)

[1.18.2godep [49](#godep)](\l)

[1.18.3go module [53](#go-module)](\l)

[1.18+1 Go语言依赖管理 [55](#go语言依赖管理-1)](\l)

[1.18.1 GOPATH和GOVENDOR工作模式 [56](#gopath和govendor工作模式)](\l)

[1.18.1.1 GOPATH工作模式 [56](#gopath工作模式)](\l)

[1.18.1.2 GOVENDOR工作模式 [56](#govendor工作模式)](\l)

[1.18.2 go mod的使用 [58](#go-mod的使用)](\l)

[1.18+2 Go语言基础知识4------依赖管理
[61](#go语言基础知识4依赖管理)](\l)

[1.19 第一个Go语言程序 [66](#第一个go语言程序)](\l)

[1.20 Go语言程序的编译和运行 [68](#go语言程序的编译和运行)](\l)

[go build 命令 [69](#go-build-命令)](\l)

[go run 命令 [71](#go-run-命令)](\l)

[1.21 Goland下载和安装 [71](#goland下载和安装)](\l)

[Goland 2019下载和安装（带破解补丁和汉化包）
[71](#goland-2019下载和安装带破解补丁和汉化包)](\l)

[Goland 简介 [71](#goland-简介)](\l)

[Goland 下载和安装 [72](#goland-下载和安装)](\l)

[运行 Goland 并激活 [75](#运行-goland-并激活)](\l)

[Goland 汉化 [79](#goland-汉化)](\l)

[1.22 Goland入门指南（使用Goland创建并运行项目）
[81](#goland入门指南使用goland创建并运行项目)](\l)

[创建项目 [81](#创建项目)](\l)

[编辑运行/调试配置 [83](#编辑运行调试配置)](\l)

[编写并运行代码 [85](#编写并运行代码)](\l)

[1.23 Goland常用快捷键 [87](#goland常用快捷键)](\l)

[Goland 快捷键设置 [87](#goland-快捷键设置)](\l)

[Goland 常用快捷键 [88](#goland-常用快捷键)](\l)

[1.24 LiteIDE搭建Go语言开发环境 [90](#liteide搭建go语言开发环境)](\l)

[下载 LiteIDE [90](#下载-liteide)](\l)

[配置 LiteIDE [93](#配置-liteide)](\l)

[新建项目 [98](#新建项目)](\l)

# 第1章 Go语言简介

Go 语言是一门新生语言，从其出现就备受大家的喜爱。本章会带领读者领略 Go
语言的特性，介绍 Go
语言在国内外公司及项目的应用情况，同时让读者了解这门强大语言背后的三位缔造者及团队成员。\
\
为了方便读者跟着本教程的步骤进行操作和实践，本章还会介绍如何搭建 Go
语言的开发环境。

## 1.1 Go语言简介

Go语言（或 Golang）起源于 2007 年，并在 2009 年正式对外发布。Go
是非常年轻的一门语言，它的主要目标是"兼具 Python 等动态语言的开发速度和
C/C++ 等编译型语言的性能与安全性"。\
\
Go语言是编程语言设计的又一次尝试，是对类C语言的重大改进，它不但能让你访问底层操作系统，还提供了强大的网络编程和并发编程支持。Go语言的用途众多，可以进行网络编程、系统编程、并发编程、分布式编程。\
\
Go语言的推出，旨在不损失应用程序性能的情况下降低代码的复杂性，具有"部署简单、并发性好、语言设计良好、执行性能好"等优势，目前国内诸多
IT 公司均已采用Go语言开发项目。\
\
Go语言有时候被描述为"C 类似语言"，或者是"21 世纪的C语言"。Go
从C语言继承了相似的表达式语法、控制流结构、基础数据类型、调用参数传值、指针等很多思想，还有C语言一直所看中的编译后机器码的运行效率以及和现有操作系统的无缝适配。\
\
因为Go语言没有类和继承的概念，所以它和 Java 或 C++
看起来并不相同。但是它通过接口（interface）的概念来实现多态性。Go语言有一个清晰易懂的轻量级类型系统，在类型之间也没有层级之说。因此可以说Go语言是一门混合型的语言。\
\
此外，很多重要的开源项目都是使用Go语言开发的，其中包括 Docker、Go-Ethereum、Thrraform
和 Kubernetes。

### Go语言创始人

对语言进行评估时，明白设计者的动机以及语言要解决的问题很重要。Go语言出自
Ken Thompson 和 Rob Pike、Robert
Griesemer 之手，他们都是计算机科学领域的重量级人物。

#### 1) Ken Thompson

贝尔实验室 Unix 团队成员，C语言、Unix 和 Plan 9 的创始人之一，在 20 世纪
70 年代，设计并实现了最初的 UNIX
操作系统，仅从这一点说，他对计算机科学的贡献怎么强调都不过分。他还与 Rob
Pike 合作设计了 UTF-8 编码方案。

#### 2) Rob Pike

Go语言项目总负责人，贝尔实验室 Unix 团队成员，除帮助设计 UTF-8
外，还帮助开发了分布式多用户操作系统 Plan 9、Inferno 操作系统和 Limbo
编程语言，并与人合著了《The Unix Programming Environment》，对 UNIX
的设计理念做了正统的阐述。

#### 3) Robert Griesemer

就职于 Google，参与开发 Java HotSpot
虚拟机，对语言设计有深入的认识，并负责 Chrome 浏览器和 Node.js 使用的
Google V8 JavaScript 引擎的代码生成部分。\
\
这些计算机科学领城的重量级人物设计Go语言的初衷是满足 Google
的需求。设计此语言花费了两年的时间，融入了整个团队多年的经验及对编程语言设计的深入认识。设计团队借鉴了
Pascal、Oberon
和C语言的设计智慧，同时让Go语言具备动态语言的便利性。因此，Go语言体现了经验丰富的计算机科学家的语言设计理念，是为全球最大的互联网公司之一设计的。\
\
Go语言的所有设计者都说，设计Go语言是因为 C++ 给他们带来了挫败感。在
Google I/O 2012 的 Go 设计小组见面会上，Rob Pike 是这样说的：

> 我们做了大量的 C++
> 开发，厌烦了等待编译完成，尽管这是玩笑，但在很大程度上来说也是事实。

### Go 是编译型语言

Go
使用编译器来编译代码。编译器将源代码编译成二进制（或字节码）格式；在编译代码时，编译器检查错误、优化性能并输出可在不同平台上运行的二进制文件。要创建并运行
Go 程序，程序员必须执行如下步骤。

1.  使用文本编辑器创建 Go 程序；

2.  保存文件；

3.  编译程序；

4.  运行编译得到的可执行文件。

这不同于 Python、Ruby 和 JavaScript 等语言，它们不包含编译步骤。Go
自带了编译器，因此无须单独安装编译器。

### 为什么要学习Go语言

如果你要创建系统程序，或者基于网络的程序，Go语言是很不错的选择。作为一种相对较新的语言，它是由经验丰富且受人尊敬的计算机科学家设计的，旨在应对创建大型并发网络程序面临的挑战。\
\
在Go语言出现之前，开发者们总是面临非常艰难的抉择，究竟是使用执行速度快但是编译速度并不理想的语言（如：C++），还是使用编译速度较快但执行效率不佳的语言（如：.NET、Java），或者说开发难度较低但执行速度一般的动态语言呢？显然，Go语言在这
3 个条件之间做到了最佳的平衡：快速编译，高效执行，易于开发。\
\
Go语言支持交叉编译，比如说你可以在运行 Linux 系统的计算机上开发可以在
Windows 上运行的应用程序。这是第一门完全支持 UTF-8
的编程语言，这不仅体现在它可以处理使用 UTF-8
编码的字符串，就连它的源码文件格式都是使用的 UTF-8
编码。Go语言做到了真正的国际化！

### Go语言吉祥物

Go语言有一个吉祥物，在会议、文档页面和博文中，大多会包含下图所示的 Go
Gopher，这是才华横溢的插画家 Renee French 设计的，她也是 Go 设计者之一
Rob Pike 的妻子。

![IMG_256](media/image1.jpeg){width="0.4625in" height="0.625in"}

## 1.2 Go语言的特性

Go语言也称为 Golang，是由 Google
公司开发的一种静态强类型、编译型、并发型、并具有垃圾回收功能的编程语言。\
\
接下来从几个方面来具体介绍一下Go语言的特性。

### 语法简单

抛开语法样式不谈，单就类型和规则而言，Go 与 C99、C11
相似之处颇多，这也是Go语言被冠以"NextC"名号的重要原因。\
\
Go语言的语法处于简单和复杂的两极。C语言简单到你每写下一行代码，都能在脑中想象出编译后的模样，指令如何执行，内存如何分配，等等。而
C 的复杂在于，它有太多隐晦而不着边际的规则，着实让人头疼。相比较而言，Go
从零开始，没有历史包袱，在汲取众多经验教训后，可从头规划一个规则严谨、条理简单的世界。\
\
Go语言的语法规则严谨，没有歧义，更没什么黑魔法变异用法。任何人写出的代码都基本一致，这使得Go语言简单易学。放弃部分"灵活"和"自由"，换来更好的维护性，我觉得是值得的。\
\
将"++"、"\--"从运算符降级为语句，保留指针，但默认阻止指针运算，带来的好处是显而易见的。还有，将切片和字典作为内置类型，从运行时的层面进行优化，这也算是一种"简单"。

### 并发模型

时至今日，并发编程已成为程序员的基本技能，在各个技术社区都能看到诸多与之相关的讨论主题。在这种情况下Go语言却一反常态做了件极大胆的事，从根本上将一切都并发化，运行时用
Goroutine 运行所有的一切，包括 main.main 入口函数。\
\
可以说，Goroutine 是 Go
最显著的特征。它用类协程的方式来处理并发单元，却又在运行时层面做了更深度的优化处理。这使得语法上的并发编程变得极为容易，无须处理回调，无须关注线程切换，仅一个关键字，简单而自然。\
\
搭配 channel，实现 CSP
模型。将并发单元间的数据耦合拆解开来，各司其职，这对所有纠结于内存共享、锁粒度的开发人员都是一个可期盼的解脱。若说有所不足，那就是应该有个更大的计划，将通信从进程内拓展到进程外，实现真正意义上的分布式。

### 内存分配

将一切并发化固然是好，但带来的问题同样很多。如何实现高并发下的内存分配和管理就是个难题。好在
Go 选择了 tcmalloc，它本就是为并发而设计的高性能内存分配组件。\
\
可以说，内存分配器是运行时三大组件里变化最少的部分。刨去因配合垃圾回收器而修改的内容，内存分配器完整保留了
tcmalloc 的原始架构。使用 cache 为当前执行线程提供无锁分配，多个 central
在不同线程间平衡内存单元复用。在更高层次里，heap
则管理着大块内存，用以切分成不同等级的复用内存块。快速分配和二级内存平衡机制，让内存分配器能优秀地完成高压力下的内存管理任务。\
\
在最近几个版本中，编译器优化卓有成效。它会竭力将对象分配在栈上，以降低垃圾回收压力，减少管理消耗，提升执行性能。可以说，除偶尔因性能问题而被迫采用对象池和自主内存管理外，我们基本无须参与内存管理操作。

### 垃圾回收

垃圾回收一直是个难题。早年间，Java 就因垃圾回收低效被嘲笑了许久，后来
Sun 连续收纳了好多人和技术才发展到今天。可即便如此，在 Hadoop
等大内存应用场景下，垃圾回收依旧捉襟见肘、步履维艰。\
\
相比 Java，Go
面临的困难要更多。因指针的存在，所以回收内存不能做收缩处理。幸好，指针运算被阻止，否则要做到精确回收都难。\
\
每次升级，垃圾回收器必然是核心组件里修改最多的部分。从并发清理，到降低
STW 时间，直到 Go 的 1.5
版本实现并发标记，逐步引入三色标记和写屏障等等，都是为了能让垃圾回收在不影响用户逻辑的情况下更好地工作。尽管有了努力，当前版本的垃圾回收算法也只能说堪用，离好用尚有不少距离。

### 静态链接

Go
刚发布时，静态链接被当作优点宣传。只须编译后的一个可执行文件，无须附加任何东西就能部署。这似乎很不错，只是后来风气变了。连着几个版本，编译器都在完善动态库
buildmode 功能，场面一时变得有些尴尬。\
\
暂不说未完工的 buildmode
模式，静态编译的好处显而易见。将运行时、依赖库直接打包到可执行文件内部，简化了部署和发布操作，无须事先安装运行环境和下载诸多第三方库。这种简单方式对于编写系统软件有着极大好处，因为库依赖一直都是个麻烦。

### 标准库

功能完善、质量可靠的标准库为编程语言提供了充足动力。在不借助第三方扩展的情况下，就可完成大部分基础功能开发，这大大降低了学习和使用成本。最关键的是，标准库有升级和修复保障，还能从运行时获得深层次优化的便利，这是第三方库所不具备的。\
\
Go 标准库虽称不得完全覆盖，但也算极为丰富。其中值得称道的是
net/http，仅须简单几条语句就能实现一个高性能 Web
Server，这从来都是宣传的亮点。更何况大批基于此的优秀第三方 Framework
更是将 Go 推到 Web/Microservice 开发标准之一的位置。\
\
当然，优秀第三方资源也是语言生态圈的重要组成部分。近年来崛起的几门语言中，Go
算是独树一帜，大批优秀作品频繁涌现，这也给我们学习 Go 提供了很好的参照。

### 工具链

完整的工具链对于日常开发极为重要。Go
在此做得相当不错，无论是编译、格式化、错误检查、帮助文档，还是第三方包下载、更新都有对应的工具。其功能未必完善，但起码算得上简单易用。\
\
内置完整测试框架，其中包括单元测试、性能测试、代码覆盖率、数据竞争，以及用来调优的
pprof，这些都是保障代码能正确而稳定运行的必备利器。\
\
除此之外，还可通过环境变量输出运行时监控信息，尤其是垃圾回收和并发调度跟踪，可进一步帮助我们改进算法，获得更佳的运行期表现。

## 1.3 Go语言为并发而生

在早期 CPU
都是以单核的形式顺序执行机器指令。Go语言的祖先C语言正是这种顺序编程语言的代表。顺序编程语言中的顺序是指：所有的指令都是以串行的方式执行，在相同的时刻有且仅有一个
CPU 在顺序执行程序的指令。\
\
随着处理器技术的发展，单核时代以提升处理器频率来提高运行效率的方式遇到了瓶颈，单核
CPU 发展的停滞，给多核 CPU
的发展带来了机遇。相应地，编程语言也开始逐步向并行化的方向发展。\
\
虽然一些编程语言的框架在不断地提高多核资源使用效率，例如 Java 的 Netty
等，但仍然需要开发人员花费大量的时间和精力搞懂这些框架的运行原理后才能熟练掌握。\
\
作为程序员，要开发出能充分利用硬件资源的应用程序是一件很难的事情。现代计算机都拥有多个核，但是大部分编程语言都没有有效的工具让程序可以轻易利用这些资源。编程时需要写大量的线程同步代码来利用多个核，很容易导致错误。\
\
Go语言正是在多核和网络化的时代背景下诞生的原生支持并发的编程语言。Go语言从底层原生支持并发，无须第三方库，开发人员可以很轻松地在编写程序时决定怎么使用
CPU 资源。\
\
Go语言的并发是基于 goroutine 的，goroutine
类似于线程，但并非线程。可以将 goroutine
理解为一种虚拟线程。Go语言运行时会参与调度 goroutine，并将 goroutine
合理地分配到每个 CPU 中，最大限度地使用 CPU 性能。\
\
多个 goroutine
中，Go语言使用通道（channel）进行通信，通道是一种内置的数据结构，可以让用户在不同的
goroutine 之间同步发送具有类型的消息。这让编程模型更倾向于在 goroutine
之间发送消息，而不是让多个 goroutine 争夺同一个数据的使用权。\
\
程序可以将需要并发的环节设计为生产者模式和消费者的模式，将数据放入通道。通道另外一端的代码将这些数据进行并发计算并返回结果，如下图所示。

![IMG_256](media/image2.jpeg){width="4.333333333333333in"
height="2.3958333333333335in"}

> 提示：Go语言通过通道可以实现多个 goroutine 之间内存共享。

【实例】生产者每秒生成一个字符串，并通过通道传给消费者，生产者使用两个
goroutine 并发运行，消费者在 main() 函数的 goroutine 中进行处理。

1.  package main

2.  

3.  import (

4.  \"fmt\"

5.  \"math/rand\"

6.  \"time\"

7.  )

8.  

9.  // 数据生产者

10. func producer(header string, channel chan\<- string) {

11. // 无限循环, 不停地生产数据

12. for {

13. // 将随机数和字符串格式化为字符串发送给通道

14. channel \<- fmt.Sprintf(\"%s: %v\", header, rand.Int31())

15. // 等待1秒

16. time.Sleep(time.Second)

17. }

18. }

19. 

20. // 数据消费者

21. func customer(channel \<-chan string) {

22. // 不停地获取数据

23. for {

24. // 从通道中取出数据, 此处会阻塞直到信道中返回数据

25. message := \<-channel

26. // 打印数据

27. fmt.Println(message)

28. }

29. }

30. 

31. func main() {

32. // 创建一个字符串类型的通道

33. channel := make(chan string)

34. // 创建producer()函数的并发goroutine

35. go producer(\"cat\", channel)

36. go producer(\"dog\", channel)

37. // 数据消费函数

38. customer(channel)

39. }

运行结果：

dog: 2019727887\
cat: 1298498081\
dog: 939984059\
cat: 1427131847\
cat: 911902081\
dog: 1474941318\
dog: 140954425\
cat: 336122540\
cat: 208240456\
dog: 646203300

对代码的分析：

-   第 03
    行，导入格式化（fmt）、随机数（math/rand）、时间（time）包参与编译。

-   第 10
    行，生产数据的函数，传入一个标记类型的字符串及一个只能写入的通道。

-   第 13 行，for{} 构成一个无限循环。

-   第 15 行，使用 rand.Int31() 生成一个随机数，使用 fmt.Sprintf()
    函数将 header 和随机数格式化为字符串。

-   第 18 行，使用 time.Sleep() 函数暂停 1 秒再执行这个函数。如果在
    goroutine 中执行时，暂停不会影响其他 goroutine 的执行。

-   第 23 行，消费数据的函数，传入一个只能写入的通道。

-   第 26 行，构造一个不断消费消息的循环。

-   第 28 行，从通道中取出数据。

-   第 31 行，将取出的数据进行打印。

-   第 35 行，程序的入口函数，总是在程序开始时执行。

-   第 37 行，实例化一个字符串类型的通道。

-   第 39 行和第 40
    行，并发执行一个生产者函数，两行分别创建了这个函数搭配不同参数的两个
    goroutine。

-   第 42 行，执行消费者函数通过通道进行数据消费。

整段代码中，没有线程创建，没有线程池也没有加锁，仅仅通过关键字 go 实现
goroutine，和通道实现数据交换。

## 1.4 哪些项目使用Go语言开发？

所有的编程语言都反映了语言设计者对编程哲学的反思，通常包括之前的语言所暴露的一些不足地方的改进。Go语言从发布
1.0
版本以来备受众多开发者关注并得到广泛使用，Go语言的简单、高效、并发特性吸引了众多传统语言开发者的加入，而且人数越来越多。\
\
使用Go语言开发的开源项目非常多。早期的Go语言开源项目只是通过Go语言与传统项目进行C语言库绑定实现，例如 Qt、Sqlite
等；后期的很多项目都使用Go语言进行重新原生实现，这个过程相对于其他语言要简单一些，这也促成了大量使用Go语言原生开发项目的出现。\
\
下面列举的是原生使用Go语言进行开发的部分项目。

### 1) Docker

Docker
是一种操作系统层面的虚拟化技术，可以在操作系统和应用程序之间进行隔离，也可以称之为容器。Docker
可以在一台物理服务器上快速运行一个或多个实例。例如，启动一个 CentOS
操作系统，并在其内部命令行执行指令后结束，整个过程就像自己在操作系统一样高效。\
\
项目链接：https://github.com/docker/docker

### 2) Go语言

Go语言自己的早期源码使用C语言和汇编语言写成。从 Go 1.5
版本后，完全使用Go语言自身进行编写。Go语言的源码对了解Go语言的底层调度有极大的参考意义，建议希望对Go语言有深入了解的读者读一读。\
\
项目链接：https://github.com/golang/go

### 3) Kubernetes

Google 公司开发的构建于 Docker 之上的容器调度服务，用户可以通过
Kubernetes
集群进行云端容器集群管理。系统会自动选取合适的工作节点来执行具体的容器集群调度处理工作。其核心概念是
Container Pod（容器仓）。\
\
项目链接：https://github.com/kubernetes/kubernetes

### 4) etcd

一款分布式、可靠的 KV 存储系统，可以快速进行云配置。由 CoreOS
开发并维护键值存储系统，它使用Go语言编写，并通过 Raft
一致性算法处理日志复制以保证强一致性。\
\
项目链接：https://github.com/coreos/etcd

### 5) beego

beego 是一个类似 Python 的 Tornado 框架，采用了 RESTFul
的设计思路，使用Go语言编写的一个极轻量级、高可伸缩性和高性能的 Web
应用框架。\
\
项目链接：https://github.com/astaxie/beego

### 6) martini

一款快速构建模块化的 Web 应用的Go语言框架。\
\
项目链接：https://github.com/go-martini/martini

### 7) codis

国产的优秀分布式 Redis 解决方案。可以将 codis 理解成为 Web 服务领域的
Nginx，它实现了对 Redis 的反向代理和负载均衡。\
\
项目链接：https://github.com/CodisLabs/codis

### 8) delve

Go语言强大的调试器，被很多集成环境和编辑器整合。\
\
项目链接：https://github.com/derekparker/delve

## 1.5 哪些大公司正在使用Go语言

Go语言是谷歌在 2009
年发布的一款编程语言，自面世以来它以高效的开发效率和完美的运行速度迅速风靡全球，被誉为"21
世纪的C语言"。\
\
现在越来越多的公司开始使用Go语言开发自己的服务，同时也诞生了很多使用Go语言开发的服务和应用，比如 Docker、k8s
等，下面我们来看一下，有哪些大公司在使用Go语言。

#### 1) Google

作为创造了Go语言的 google 公司，当然会力挺Go语言了。Google 有很多基于 Go
开发的开源项目，比如
kubernets，docker，大家可以参考《哪些项目使用Go语言开发》一节了解更多的Go语言开源项目。

#### 2) Facebook

Facebook 也在使用Go语言，为此他们还专门在 Github 上建立了一个开源组织
facebookgo。大家可以通过 https://github.com/facebookgo 访问查看 facebook
开源的项目，其中最具代表性的就是著名平滑重启工具 grace。

#### 3) 腾讯

腾讯在 15 年就已经做了 Docker 万台规模的实践。因为腾讯主要的开发语言是
C/C++ ，所以在使用Go语言方面会方便很多，也有很多优势，不过日积月累的
C/C++ 代码很难改造，也不敢动，所以主要在新业务上尝试使用 Go。

#### 4) 百度

百度主要在运维方面使用到了Go语言，比如百度运维的一个 BFE
项目，主要负责前端流量的接入，其次就是百度消息通讯系统的服务器端也使用到了Go语言。

#### 5) 七牛云

七牛云算是国内第一家选Go语言做服务端的公司。早在 2011
年，当Go语言的语法还没完全稳定下来的情况下，七牛云就已经选择将 Go
作为存储服务端的主体语言。

#### 6) 京东

京东云消息推送系统、云存储，以及京东商城的列表页等都是使用Go语言开发的。

#### 7) 小米

小米对Go语言的支持，在于运维监控系统的开源，它的官方网址是 http://open-falcon.org/。此外，小米互娱、小米商城、小米视频、小米生态链等团队都在使用Go语言。

#### 8) 360

360 对Go语言的使用也不少，比如开源的日志搜索系统
Poseidon，大家可以通过 https://github.com/Qihoo360/poseidon 查看，还有
360 的推送团队也在使用Go语言。\
\
除了上面提到的，还有很多公司开始尝试使用Go语言，比如美团、滴滴、新浪等。\
\
Go语言的强项在于它适合用来开发网络并发方面的服务，比如消息推送、监控、容器等，所以在高并发的项目上大多数公司会优先选择
Golang 作为开发语言。

关注公众号「站长严长生」，在手机上阅读所有教程，随时随地都能学习。内含一款搜索神器，免费下载全网书籍和视频。

## 1.6 Go语言适合做什么

> go语言适合做以下4个方面工作：1、服务器端开发；2、服务器编程语言；3、网络编程；4、内存数据库和云平台领域开发。其中，服务器端开发主要指开发"大型软件"，适合于很多程序员一起开发大型软件，并且开发周期长，支持云计算的网络服务。

### 1、服务器端开发

go语言的服务器端开发是用来开发"大型软件"的，适合于很多程序员一起开发大型软件，并且开发周期长，支持云计算的网络服务。Go语言能够让程序员快速开发，并且在软件不断的增长过程中，它能让程序员更容易地进行维护和修改。它融合了传统编译型语言的高效性和脚本语言的易用性和富于表达性。

### 2、服务器编程语言

go语言作为服务器编程语言，很适合处理日志、**数据打包、虚拟机处理、文件系统、分布式系统、数据库代理**等。

### 3、网络编程

网络编程方面，go语言广泛应用于**Web应用、API应用、下载应用**等，大量优秀的Web框架如Echo、Gin、Iris、beego等，而且
go内置的 net/http 包十分的优秀。

### 4、内存数据库和云平台领域开发

go语言还适用于内存数据库和云平台领域，目前国外很多云平台都是采用go开发。

### 拓展阅读

#### 什么是Go语言？

**Go（又称Golang）**是Google开发的一种静态强类型、编译型、并发型，并具有垃圾回收功能的编程语言。

#### Go语言有哪些优势？

-   学习曲线容易

Go语言语法简单，包含了类C语法。

-   效率：快速的编译时间，开发效率和运行效率高

开发过程中相较于 Java 和 C++呆滞的编译速度，Go
的快速编译时间是一个主要的效率优势。Go拥有接近C的运行效率和接近PHP的开发效率。

-   出身名门、血统纯正

之所以说Go出身名门，从Go语言的创造者就可见端倪，Go语言绝对血统纯正。其次Go语言出自Google公司，Google在业界的知名度和实力自然不用多说。

-   自由高效：组合的思想、无侵入式的接口

Go语言可以说是开发效率和运行效率二者的完美融合，天生的并发编程支持。Go语言支持当前所有的编程范式，包括过程式编程、面向对象编程、面向接口编程、函数式编程。程序员们可以各取所需、自由组合、想怎么玩就怎么玩。

-   强大的标准库

这包括互联网应用、系统编程和网络编程。Go里面的标准库基本上已经是非常稳定了，特别是我这里提到的三个，网络层、系统层的库非常实用。Go
语言的 lib 库麻雀虽小五脏俱全。

-   部署方便：二进制文件，Copy部署

这一点是很多人选择Go的最大理由，因为部署太方便了，所以现在也有很多人用Go开发运维程序。

-   简单的并发

并行和异步编程几乎无痛点。Go 语言的 Goroutine 和 Channel
这两个神器简直就是并发和异步编程的巨大福音。Go
是一种非常高效的语言，高度支持并发性。Go是为大数据、微服务、并发而生的一种编程语言。

-   稳定性

Go提供了软件生命周期（开发、测试、部署、维护等等）的各个环节的工具，如go
tool、gofmt、go
test。Go拥有强大的编译检查、严格的编码规范和完整的软件生命周期工具，具有很强的稳定性，稳定压倒一切。

## 1.7 [Go语言和其它编程语言的对比](http://c.biancheng.net/view/vip_7299.html)

Go的很多语言特性借鉴与它的三个祖先：C，Pascal和CSP。Go的语法、数据类型、控制流等继承于C，Go的包、面对对象等思想来源于Pascal分支，而Go最大的语言特色，基于管道通信的协程并发模型，则借鉴于CSP分支。

![IMG_256](media/image3.jpeg){width="5.561111111111111in"
height="5.654861111111111in"}

Java

编译语言，速度适中（2.67s），目前的大型网站都是拿java写的，比如淘宝、京东等。主要特点是稳定，开源性好，具有自己的一套编写规范，开发效率适中，目前最主流的语言。

作为编程语言中的大腕。具有最大的知名度和用户群。无论风起云涌，我自巍然不动。他强任他强，清风拂山岗；他横由他横，明月照大江。

c#

执行速度快（4.28），学习难度适中，开发速度适中。但是由于c#存在很多缺点，京东、携程等大型网站前身都是用c#开发的，但是现在都迁移到了java上。

C/C++

现存编程语言中的老祖，其他语言皆由此而生。执行速度最快无人能及。但是写起来最为复杂，开发难度大。

Javascript

编程语言中特立独行的傲娇美女。前端处理能力是其它语言无法比拟。发展中的js后端处理能力也是卓越不凡。前后端通吃，舍我其谁？

Python

脚本语言，速度最慢（258s），代码简洁、学习进度短，开发速度快。豆瓣就是拿python写的。Python著名的服务器框架有django，flask。但是python在大型项目上不太稳定，因此有些用python的企业后来迁移到了java上。

scala

编译语言，比python快十倍，和java差不多，但是学习进度慢，而且在实际编程中，如果对语言不够精通，很容易造成性能严重下降。，后来比如Yammer就从scala迁移到了java上。微服务框架有lagom等。

Go

编程界的小鲜肉。高并发能力无人能及。即具有像Python一样的简洁代码、开发速度，又具有C语言一样的执行效率，优势突出。

四、最后

因为Go的语法和Erlang、Python类似，所以我们将这三门语言做个详细的对比。

相比于Python的40个特性，Go只有31个，可以说Go在语言设计上是相当克制的。比如，它没有隐式的数值转换，没有构造函数和析构函数，没有运算符重载，没有默认参数，也没有继承，没有泛型，没有异常，没有宏，没有函数修饰，更没有线程局部存储。

但是Go的特点也很鲜明，比如，它拥有协程、自动垃圾回收、包管理系统、一等公民的函数、栈空间管理等。

Go作为静态类型语言，保证了Go在运行效率、内存用量、类型安全都要强于Python和Erlang。

Go的数据类型也更加丰富，除了支持表、字典等复杂的数据结构，还支持指针和接口类型，这是Python和Erlang所没有的。特别是接口类型特别强大，它提供了管理类型系统的手段。而指针类型提供了管理内存的手段，这让Go进入底层软件开发提供了强有力的支持。

Go在面对对象的特性支持上做了很多反思和取舍，它没有类、虚函数、继承、泛型等特性。Go语言中面向对象编程的核心是组合和方法(function)。组合很类似于C语言的struct结构体的组合方式，方法类似于Java的接口(Interface)，但是使用方法上与对象更加解耦，减少了对对象内部的侵入。Erlang则不支持面对对象编程范式，相比而言，Python对面对对象范式的支持最为全面。

在函数式编程的特性支持上，Erlang作为函数式语言，支持最为全面。但是基本的函数式语言特性，如lambda、高阶函数、curry等，三种语言都支持。

控制流的特性支持上，三种语言都差不多。Erlang支持尾递归优化，这给它在函数式编程上带来便利。而Go在通过动态扩展协程栈的方式来支持深度递归调用。Python则在深度递归调用上经常被爆栈。

Go和Erlang的并发模型都来源于CSP，但是Erlang是基于actor和消息传递（mailbox）的并发实现，Go是基于goroutine和管道（channel）的并发实现。不管Erlang的actor还是Go的goroutine，都满足协程的特点：由编程语言实现和调度，切换在用户态完成，创建销毁开销很小。至于Python，其多线程的切换和调度是基于操作系统实现，而且因为GIL的大坑级存在，无法真正做到并行。

而且从笔者的并发编程体验上看，Erlang的函数式编程语法风格和其OTP
behavior框架提供的晦涩的回调（callback）使用方法，对大部分的程序员，如C/C++和Java出身的程序员来说，有一定的入门门槛和挑战。而被称为"互联网时代的C"的Go，其类C的语法和控制流，以及面对对象的编程范式，编程体验则好很多。

发布于 2022-03-16 16:21

## 1.8 [Go语言的性能如何？](http://c.biancheng.net/view/4.html)

根据 Go 开发团队和基本的算法测试，Go语言与C语言的性能差距大概在 10%\~20%
之间。虽然没有官方的性能标准，但是与其它各个语言相比已经拥有非常出色的表现。\
\
时下流行的语言大都是运行在虚拟机上，如：Java 和 Scala 使用的 JVM，C# 和
VB.NET 使用的 .NET CLR。尽管虚拟机的性能已经有了很大的提升，但任何使用
JIT 编译器和脚本语言解释器的编程语言（Ruby、Python、Perl
和 JavaScript）在 C 和 C++ 的绝对优势下甚至都无法在性能上望其项背。\
\
这里以国外的一个编程语言性能测试网站
http://benchmarksgame.alioth.debian.org/
为测试基准和数据源。这个网站可以对常见的编程语言进行性能比较，网站使用都是最新的语言版本和常见的一些算法。\
\
通过对 C(gcc)、C++、Java、JavaScript
和Go语言的测试。性能比较如下表所示，表中数据的单位为秒，数值越小表明运行性能越好。

  ---------------------------- ------------------------ -------------- -------------------- ----------- ------------------- ------------ ------------------ ---------------- ------------------ -----------------
  常见编程语言的运行性能比较                                                                                                                                                                    

  **编程语言↓ / 测试用例→**    **reverse-complement**   **pidigits**   **fannkuch-redux**   **fasta**   **spectral-norm**   **n-body**   **k-nucleotide**   **mandelbrot**   **binary-trees**   **regex-redux**

  **C语言**                    0.42                     1.73           8.97                 1.33        1.99                9.96         5.38               1.65             2.38               1.45

  **C++**                      0.6                      1.89           10.35                1.48        1.99                9.31         7.18               1.73             2.36               17.14

  **Go**                       0.49                     2.02           14.49                2.17        3.96                21.47        14.79              5.46             35.18              29.29

  **Java**                     1.13                     3.12           15.09                2.32        4.25                22.56        8.38               6.08             8.58               10.38

  **JavaScript**               4.3                      N/A            81.49                9.79        16.17               28.74        66.07              19.04            53.64              4.44
  ---------------------------- ------------------------ -------------- -------------------- ----------- ------------------- ------------ ------------------ ---------------- ------------------ -----------------

通过上表可以看出，Go语言在性能上更接近于 Java
语言，虽然在某些测试用例上不如经过多年优化的 Java 语言，但毕竟 Java
语言已经经历了多年的积累和优化。Go语言在未来的版本中会通过不断的版本优化提高单核运行性能。

## 1.9 [Go语言标准库强大](http://c.biancheng.net/view/5.html)

学习编程语言，早已不是学一点语法规则那么简单。现在更习惯称作选择
Ecosystem（生态圈），而这其中标准库的作用和分量尤为明显。\
\
在Go语言的安装文件里包含了一些可以直接使用的包，即标准库。Go语言的标准库（通常被称为语言自带的电池），提供了清晰的构建模块和公共接口，包含
I/O
操作、文本处理、图像、密码学、网络和分布式应用程序等，并支持许多标准化的文件格式和编解码协议。\
\
在 Windows 下，标准库的位置在Go语言根目录下的子目录 pkg\\windows_amd64
中；在 Linux 下，标准库在Go语言根目录下的子目录 pkg\\linux_amd64
中（如果是安装的是 32 位，则在 linux_386
目录中）。一般情况下，标准包会存放在 \$GOROOT/pkg/\$GOOS\_\$GOARCH/
目录下。\
\
Go语言的编译器也是标准库的一部分，通过词法器扫描源码，使用语法树获得源码逻辑分支等。Go语言的周边工具也是建立在这些标准库上。在标准库上可以完成几乎大部分的需求。\
\
Go语言的标准库以包的方式提供支持，下表列出了Go语言标准库中常见的包及其功能。

  ---------------------------- ------------------------------------------------------------------
  Go语言标准库常用的包及功能   

  **Go语言标准库包名**         **功  能**

  bufio                        带缓冲的 I/O 操作

  bytes                        实现字节操作

  container                    封装堆、列表和环形列表等容器

  crypto                       加密算法

  database                     数据库驱动和接口

  debug                        各种调试文件格式访问及调试功能

  encoding                     常见算法如 JSON、XML、Base64 等

  flag                         命令行解析

  fmt                          格式化操作

  go                           Go语言的词法、语法树、类型等。可通过这个包进行代码信息提取和修改

  html                         HTML 转义及模板系统

  image                        常见图形格式的访问及生成

  io                           实现 I/O 原始访问接口及访问封装

  math                         数学库

  net                          网络库，支持 Socket、HTTP、邮件、RPC、SMTP 等

  os                           操作系统平台不依赖平台操作封装

  path                         兼容各操作系统的路径操作实用函数

  plugin                       Go 1.7 加入的插件系统。支持将代码编译为插件，按需加载

  reflect                      语言反射支持。可以动态获得代码中的类型信息，获取和修改变量的值

  regexp                       正则表达式封装

  runtime                      运行时接口

  sort                         排序接口

  strings                      字符串转换、解析及实用函数

  time                         时间接口

  text                         文本模板及 Token 词法器
  ---------------------------- ------------------------------------------------------------------

当然，优秀第三方资源也是语言生态圈的重要组成部分。近年来崛起的几门语言中，Go
算是独树一帜，大批优秀作品频繁涌现，这也给我们学习 Go 提供了很好的参照。

## 1.10 Go语言上手简单

Go语言语法简单易懂，学习曲线平缓，不需要像
C/C++ 语言动辄需要两到三年的学习期。Go语言被称为"互联网时代的C语言"。互联网的短、频、快特性在Go语言中体现得淋漓尽致。一个熟练的开发者只需要短短的一周时间就可以从学习阶段转到开发阶段，并完成一个高并发的服务器开发。\
\
Go语言是 Google
公司开发的一种静态型、编译型并自带垃圾回收和并发的编程语言。所以它是一门类型安全的语言，加上通过构建到本地代码，程序的执行速度也非常快。\
\
Go语言的主要目标是将静态语言的安全性和高效性与动态语言的易开发性进行有机结合，达到完美平衡，从而使编程变得更加有乐趣，而不是在艰难抉择中痛苦前行。\
\
Go语言在拥有一些动态语言的特性的同时，其语法风格类似于C语言。在C语言的基础上进行了大幅的简化，去掉了不需要的表达式括号，循环也只有
for
一种表示方法，就可以实现数值、键值等各种遍历。因此，Go语言上手非常容易。\
\
很多读者表示自己是在看了介绍后才开始了解这门语言的，他们一般也会使用两到三门编程语言。Go语言对于他们来说，也就是一到两天的熟悉过程，之后就可以开始使用Go语言解决具体问题了，大约一周左右已经可以使用Go语言完成既定的任务了。\
\
Go语言这种从零开始使用到解决问题的速度，在其他语言中是完全不可想象的。学过
C++
的朋友都知道，一到两年大强度的理论学习和实战操练也只能学到这门语言的皮毛，以及知道一些基本的避免错误的方法。\
\
那么，Go语言到底有多么简单？下面通过实现一个 HTTP 服务器来了解一下。\
\
【实例】HTTP 文件服务器是常见的 Web
服务之一。开发阶段为了测试，需要自行安装 Apache 或 Nginx
服务器，下载安装配置需要大量的时间。使用Go语言实现一个简单的 HTTP
服务器只需要几行代码，如下所示。

package main

import (

\"net/http\"

)

func main() {

http.Handle(\"/\", http.FileServer(http.Dir(\".\")))

http.ListenAndServe(\":8080\", nil)

}

下面是代码说明：

-   第 1 行，标记当前文件为 main 包，main 包也是 Go 程序的入口包。

-   第 3\~5 行，导入 net/http 包，这个包的作用是 HTTP 的基础封装和访问。

-   第 7 行，程序执行的入口函数 main()。

-   第 8 行，使用 http.FileServer
    文件服务器将当前目录作为根目录（/目录）的处理器，访问根目录，就会进入当前目录。

-   第 9 行，默认的 HTTP 服务侦听在本机 8080 端口。

把这个源码保存为
main.go（Go语言的源文件后缀就是.go），安装Go语言的开发包（后续我们会讲解如何安装），在命令行输入如下命令：

\$ go run main.go

在浏览器里输入http://127.0.0.1:8080即可浏览文件，这些文件正是当前目录在HTTP服务器上的映射目录。

### Go语言工程结构简单

Go语言的源码无须头文件，编译的文件都来自于后缀名为.go的源码文件。\
\
Go语言无须解决方案、工程文件和 Make File，只要将工程文件按照 GOPATH
的规则进行填充，即可使用 go build/go install
进行编译，编译完成的二进制可执行文件统一放在 bin 文件夹下。\
\
后面的章节会介绍 GOPATH 及 go build/go install 的详细使用方法。

### Go语言编译速度快

Go语言可以利用自己的特性实现并发编译，并发编译的最小元素是包。从 Go 1.9
版本开始，最小并发编译元素缩小到函数，整体编译速度提高了 20%。\
\
另外，Go语言语法简单，具有严谨的工程结构设计、没有头文件、不允许包的交叉依赖等规则，在很大程度上加速了编译的过程。

## 1.11 Go语言代码风格清晰、简单

Go语言语法类似于C语言，因此熟悉C语言及其派生语言（C++、C#、Objective-C
等）的人都会迅速熟悉这门语言。\
\
C语言的有些语法会让代码可读性降低甚至发生歧义。Go语言在C语言的基础上取其精华，弃其糟粕，将C语言中较为容易发生错误的写法进行调整，做出相应的编译提示。

### 1) 去掉循环冗余括号

Go语言在众多大师的丰富实战经验的基础上诞生，去除了C语言语法中一些冗余、烦琐的部分。下面的代码是C语言的数值循环：

1.  // C语言的for数值循环

2.  **for**(int a = 0;a\<10;a++){

3.  // 循环代码

4.  }

在Go语言中，这样的循环变为：

1.  for a := 0;a\<10;a++{

2.  // 循环代码

3.  }

for 两边的括号被去掉，int 声明被简化为:=，直接通过编译器右值推导获得 a
的变量类型并声明。

### 2) 去掉表达式冗余括号

同样的简化也可以在判断语句中体现出来，以下是C语言的判断语句：

1.  **if** (表达式){

2.  // 表达式成立

3.  }

在Go语言中，无须添加表达式括号，代码如下：

1.  if 表达式{

2.  // 表达式成立

3.  }

### 3) 强制的代码风格

Go语言中，左括号必须紧接着语句不换行。其他样式的括号将被视为代码编译错误。这个特性刚开始会使开发者有一些不习惯，但随着对Go语言的不断熟悉，开发者就会发现风格统一让大家在阅读代码时把注意力集中到了解决问题上，而不是代码风格上。\
\
同时Go语言也提供了一套格式化工具。一些Go语言的开发环境或者编辑器在保存时，都会使用格式化工具对代码进行格式化，让代码提交时已经是统一格式的代码。

### 4) 不再纠结于 i++ 和 ++i

C语言非常经典的考试题为：

1.  int a, b;

2.  a = i++;

3.  b = ++i;

这种题目对于初学者简直摸不着头脑。为什么一个简单的自增表达式需要有两种写法？\
\
在Go语言中，自增操作符不再是一个操作符，而是一个语句。因此，在Go语言中自增只有一种写法：

i++

如果写成前置自增++i，或者赋值后自增a=i++都将导致编译错误。

## 1.12 [Go语言是怎么完成编译的](http://c.biancheng.net/view/vip_7300.html)

Go语言是一门需要编译才能运行的编程语言，也就说代码在运行之前需要通过编译器生成二进制机器码，随后二进制文件才能在目标机器上运行，如果我们想要了解Go语言的实现原理，理解它的编译过程就是一个没有办法绕过的事情。

### 预备知识

想要深入了解Go语言的编译过程，需要提前了解一下编译过程中涉及的一些术语和专业知识。这些知识其实在我们的日常工作和学习中比较难用到，但是对于理解编译的过程和原理还是非常重要的。

#### 1) 抽象语法树

在计算机科学中，抽象语法树（Abstract Syntax
Tree，AST），或简称语法树（Syntax
tree），是源代码语法结构的一种抽象表示。它以树状的形式表现编程语言的语法结构，树上的每个节点都表示源代码中的一种结构。

之所以说语法是"抽象"的，是因为这里的语法并不会表示出真实语法中出现的每个细节。比如，嵌套括号被隐含在树的结构中，并没有以节点的形式呈现。而类似于
if else 这样的条件判断语句，可以使用带有两个分支的节点来表示。

以算术表达式 1+3\*(4-1)+2 为例，可以解析出的抽象语法树如下图所示：

![IMG_256](media/image4.png){width="3.5729166666666665in"
height="3.8229166666666665in"}

抽象语法树可以应用在很多领域，比如浏览器，智能编辑器，编译器。

#### 2) 静态单赋值

在编译器设计中，静态单赋值形式（static single assignment
form，通常简写为 SSA form 或是 SSA）是中介码（IR，intermediate
representation）的属性，它要求每个变量只分配一次，并且变量需要在使用之前定义。在实践中我们通常会用添加下标的方式实现每个变量只能被赋值一次的特性，这里以下面的代码举一个简单的例子：

x := 1

x := 2

y := x

-   1

-   2

-   3

从上面的描述所知，第一行赋值行为是不需要的，因为 x
在第二行被二度赋值并在第三行被使用，在 SSA 下，将会变成下列的形式：

x1 := 1

x2 := 2

y1 := x2

-   1

-   2

-   3

从使用 SSA 的中间代码我们就可以非常清晰地看出变量 y1 的值和 x1
是完全没有任何关系的，所以在机器码生成时其实就可以省略第一步，这样就能减少需要执行的指令来优化这一段代码。

根据 Wikipedia（维基百科）对 SSA 的介绍来看，在中间代码中使用 SSA
的特性能够为整个程序实现以下的优化：

-   常数传播（constant propagation）

-   值域传播（value range propagation）

-   稀疏有条件的常数传播（sparse conditional constant propagation）

-   消除无用的程式码（dead code elimination）

-   全域数值编号（global value numbering）

-   消除部分的冗余（partial redundancy elimination）

-   强度折减（strength reduction）

-   寄存器分配（register allocation）

因为 SSA
的作用的主要作用就是代码的优化，所以是编译器后端（主要负责目标代码的优化和生成）的一部分。当然，除了
SSA
之外代码编译领域还有非常多的中间代码优化方法，优化编译器生成的代码是一个非常古老并且复杂的领域，这里就不展开介绍了。

#### 3) 指令集架构

最后要介绍的一个预备知识就是指令集架构了，指令集架构（Instruction Set
Architecture，简称
ISA），又称指令集或指令集体系，是计算机体系结构中与程序设计有关的部分，包含了基本数据类型，指令集，寄存器，寻址模式，存储体系，中断，异常处理以及外部
I/O。指令集架构包含一系列的 opcode
即操作码（机器语言），以及由特定处理器执行的基本命令。

指令集架构常见种类如下：

-   复杂指令集运算（Complex Instruction Set Computing，简称 CISC）；

-   精简指令集运算（Reduced Instruction Set Computing，简称 RISC）；

-   显式并行指令集运算（Explicitly Parallel Instruction Computing，简称
    > EPIC）；

-   超长指令字指令集运算（VLIW）。

不同的处理器（CPU）使用了大不相同的机器语言，所以我们的程序想要在不同的机器上运行，就需要将源代码根据架构编译成不同的机器语言。

### 编译原理

Go语言编译器的源代码在 cmd/compile
目录中，目录下的文件共同构成了Go语言的编译器，学过编译原理的人可能听说过编译器的前端和后端，编译器的前端一般承担着词法分析、语法分析、类型检查和中间代码生成几部分工作，而编译器后端主要负责目标代码的生成和优化，也就是将中间代码翻译成目标机器能够运行的机器码。

![IMG_256](media/image5.png){width="5.7444444444444445in"
height="0.43333333333333335in"}

Go的编译器在逻辑上可以被分成四个阶段：词法与语法分析、类型检查和 AST
转换、通用 SSA
生成和最后的机器代码生成，下面我们来分别介绍一下这四个阶段做的工作。

#### 1) 词法与语法分析

所有的编译过程其实都是从解析代码的源文件开始的，词法分析的作用就是解析源代码文件，它将文件中的字符串序列转换成
Token
序列，方便后面的处理和解析，我们一般会把执行词法分析的程序称为词法解析器
（lexer）。

而语法分析的输入就是词法分析器输出的 Token
序列，这些序列会按照顺序被语法分析器进行解析，语法的解析过程就是将词法分析生成的
Token
按照语言定义好的文法（Grammar）自下而上或者自上而下的进行规约，每一个 Go
的源代码文件最终会被归纳成一个 SourceFile 结构：

SourceFile = PackageClause \";\" { ImportDecl \";\" } { TopLevelDecl
\";\" }

-   1

标准的Golang 语法解析器使用的就是 LALR(1)
的文法，语法解析的结果其实就是上面介绍过的抽象语法树（AST），每一个 AST
都对应着一个单独的Go语言文件，这个抽象语法树中包括当前文件属于的包名、定义的常量、结构体和函数等。

如果在语法解析的过程中发生了任何语法错误，都会被语法解析器发现并将消息打印到标准输出上，整个编译过程也会随着错误的出现而被中止。

#### 2) 类型检查

当拿到一组文件的抽象语法树 AST
之后，Go语言的编译器会对语法树中定义和使用的类型进行检查，类型检查分别会按照顺序对不同类型的节点进行验证，按照以下的顺序进行处理：

-   常量、类型和函数名及类型；

-   变量的赋值和初始化；

-   函数和闭包的主体；

-   哈希键值对的类型；

-   导入函数体；

-   外部的声明；

通过对每一棵抽象节点树的遍历，我们在每一个节点上都会对当前子树的类型进行验证保证当前节点上不会出现类型错误的问题，所有的类型错误和不匹配都会在这一个阶段被发现和暴露出来。

类型检查的阶段不止会对树状结构的节点进行验证，同时也会对一些内建的函数进行展开和改写，例如
make 关键字在这个阶段会根据子树的结构被替换成 makeslice 或者 makechan
等函数。

其实类型检查不止对类型进行了验证工作，还对 AST
进行了改写以及处理Go语言内置的关键字，所以，这一过程在整个编译流程中是非常重要的，没有这个步骤很多关键字其实就没有办法工作。

#### 3) 中间代码生成

当我们将源文件转换成了抽象语法树，对整个语法树的语法进行解析并进行类型检查之后，就可以认为当前文件中的代码基本上不存在无法编译或者语法错误的问题了，Go语言的编译器就会将输入的
AST 转换成中间代码。

Go语言编译器的中间代码使用了 SSA(Static Single Assignment Form)
的特性，如果我们在中间代码生成的过程中使用这种特性，就能够比较容易的分析出代码中的无用变量和片段并对代码进行优化。

在类型检查之后，就会通过一个名为 compileFunctions
的函数开始对整个Go语言项目中的全部函数进行编译，这些函数会在一个编译队列中等待几个后端工作协程的消费，这些
Goroutine 会将所有函数对应的 AST 转换成使用 SSA 特性的中间代码。

#### 4) 机器码生成

Go语言源代码的 cmd/compile/internal
目录中包含了非常多机器码生成相关的包，不同类型的 CPU
分别使用了不同的包进行生成
amd64、arm、arm64、mips、mips64、ppc64、s390x、x86 和
wasm，也就是说Go语言能够在几乎全部常见的 CPU 指令集类型上运行。

### 编译器入口

Go语言的编译器入口是 src/cmd/compile/internal/gc 包中的 main.go
文件，这个 600 多行的 Main
函数就是Go语言编译器的主程序，这个函数会先获取命令行传入的参数并更新编译的选项和配置，随后就会开始运行
parseFiles
函数对输入的所有文件进行词法与语法分析得到文件对应的抽象语法树：

func Main(archInit func(\*Arch)) {\
// ...\
lines := parseFiles(flag.Args())

接下来就会分九个阶段对抽象语法树进行更新和编译，就像我们在上面介绍的，整个过程会经历类型检查、SSA
中间代码生成以及机器码生成三个部分：

-   检查常量、类型和函数的类型；

-   处理变量的赋值；

-   对函数的主体进行类型检查；

-   决定如何捕获变量；

-   检查内联函数的类型；

-   进行逃逸分析；

-   将闭包的主体转换成引用的捕获变量；

-   编译顶层函数；

-   检查外部依赖的声明；

了解了剩下的编译过程之后，我们重新回到词法和语法分析后的具体流程，在这里编译器会对生成语法树中的节点执行类型检查，除了常量、类型和函数这些顶层声明之外，它还会对变量的赋值语句、函数主体等结构进行检查：

for i := 0; i \< len(xtop); i++ { n := xtop\[i\] if op := n.Op; op !=
ODCL && op != OAS && op != OAS2 && (op != ODCLTYPE \|\|
!n.Left.Name.Param.Alias) { xtop\[i\] = typecheck(n, ctxStmt) }}for i :=
0; i \< len(xtop); i++ { n := xtop\[i\] if op := n.Op; op == ODCL \|\|
op == OAS \|\| op == OAS2 \|\| op == ODCLTYPE && n.Left.Name.Param.Alias
{ xtop\[i\] = typecheck(n, ctxStmt) }}for i := 0; i \< len(xtop); i++ {
n := xtop\[i\] if op := n.Op; op == ODCLFUNC \|\| op == OCLOSURE {
typecheckslice(Curfn.Nbody.Slice(), ctxStmt) }}checkMapKeys()for \_, n
:= range xtop { if n.Op == ODCLFUNC && n.Func.Closure != nil {
capturevars(n) }}escapes(xtop)for \_, n := range xtop { if n.Op ==
ODCLFUNC && n.Func.Closure != nil { transformclosure(n) }}

-   1

类型检查会对传入节点的子节点进行遍历，这个过程会对 make
等关键字进行展开和重写，类型检查结束之后并没有输出新的

数据结构

，只是改变了语法树中的一些节点，同时这个过程的结束也意味着源代码中已经不存在语法错误和类型错误，中间代码和机器码也都可以正常的生成了。

initssaconfig() peekitabs() for i := 0; i \< len(xtop); i++ { n :=
xtop\[i\] if n.Op == ODCLFUNC { funccompile(n) } } compileFunctions()
for i, n := range externdcl { if n.Op == ONAME { externdcl\[i\] =
typecheck(externdcl\[i\], ctxExpr) } } checkMapKeys()}

-   1

在主程序运行的最后，会将顶层的函数编译成中间代码并根据目标的 CPU
架构生成机器码，不过这里其实也可能会再次对外部依赖进行类型检查以验证正确性。

### 总结

Go语言的编译过程其实是非常有趣并且值得学习的，通过对Go语言四个编译阶段的分析和对编译器主函数的梳理，我们能够对
Golang
的实现有一些基本的理解，掌握编译的过程之后，Go语言对于我们来讲也不再那么神秘，所以学习其编译原理的过程还是非常有必要的。

## 1.13 [在Windows上安装Go语言开发包](http://c.biancheng.net/view/3992.html)

通过前面几节的学习，相信大家已经对Go语言有了一定的了解，接下来将为大家介绍如何在我们的电脑上安装Go语言开发包，首先从
Windows 系统开始。

### 1.13.1下载Go语言开发包

大家可以在Go语言官网（https://golang.google.cn/dl/）下载 Windows
系统下的Go语言开发包，如下图所示。

![IMG_256](media/image6.png){width="5.779166666666667in"
height="2.716666666666667in"}

这里我们下载的是 64 位的开发包，如果读者的电脑是 32
位系统的话，则需要下载 32 位的开发包，在上图所示页面中向下滚动即可找到
32 位开发包的下载地址，如下图所示。

![IMG_257](media/image7.png){width="8.333333333333334in"
height="3.9166666666666665in"}

注意：下载 Windows 版本的Go语言开发包时尽量选择 MSI
格式，因为它可以直接安装到系统，不需要额外的操作。

### 1.13.2安装Go语言开发包

双击我们下载好的Go语言开发包即可启动安装程序，如下图所示，这是Go语言的用户许可协议，无需管它，直接勾选"I
accept \..."然后点击"Next"即可。

![IMG_258](media/image8.png){width="5.135416666666667in"
height="3.75in"}

在 Windows 系统下Go语言开发包会默认安装到 C 盘的 Go
目录下，推荐在这个目录下安装，使用起来较为方便。当然，你也可以选择其他的安装目录，确认无误后点击"Next"，如下图所示：

![IMG_259](media/image9.png){width="5.15625in" height="4.03125in"}

Go语言开发包的安装没有其他需要设置的选项，点击"Install"即可开始安装，如下图所示：

![IMG_260](media/image10.png){width="5.15625in" height="4.03125in"}

等待程序完成安装，然后点击"Finish"退出安装程序。

![IMG_261](media/image11.png){width="3.895138888888889in"
height="3.045138888888889in"}

安装完成后，在我们所设置的安装目录下将生成一些目录和文件，如下图所示：

![IMG_262](media/image12.png){width="5.595138888888889in"
height="3.928472222222222in"}

这个目录的结构遵守 GOPATH
规则，后面的章节会提到这个概念。目录中各个文件夹的含义如下表所示。

  ------------------------------ --------------------------------------------------------------------
  Go                             
  开发包的安装目录的功能及说明   

  **目录名**                     **说明**

  api                            每个版本的 api 变更差异

  bin                            go
                                 源码包编译出的编译器（go）、文档工具（godoc）、格式化工具（gofmt）

  doc                            英文版的 Go 文档

  lib                            引用的一些库文件

  misc                           杂项用途的文件，例如 Android 平台的编译、git 的提交钩子等

  pkg                            Windows 平台编译好的中间文件

  src                            标准库的源码

  test                           测试用例
  ------------------------------ --------------------------------------------------------------------

开发时，无须关注这些目录。如果读者希望深度了解底层原理，可以通过上面的介绍继续探索。

### 1.13.3设置环境变量

开发包安装完成后，我们还需要配置一下GOPATH 环境变量，之后才可以使用Go语言进行开发。GOPATH
是一个路径，用来存放开发中需要用到的代码包。\
\
在桌面或者资源管理器右键"此电脑"（或者"我的电脑"）→"属性"→"高级系统设置"→"环境变量"，如下图所示。

![IMG_263](media/image13.png){width="5.41875in"
height="2.953472222222222in"}

在弹出的菜单里找到 GOPATH
对应的选项点击编辑之后就可以修改了，没有的话可以选择新建，并将变量名填写为
GOPATH，变量值设置为任意目录均可（尽量选择空目录），例如 D:\\Go。

![IMG_264](media/image14.png){width="6.416666666666667in"
height="6.833333333333333in"}

提示：填写完成后，每个打开的窗口都需要点击"确定"来保存设置。

其它的环境变量安装包均会进行自动设置。在默认情况下，Go 将会被安装在目录
c:\\go
下，但如果你在安装过程中修改安装目录，则可能需要手动修改所有的环境变量的值。\
\
环境变量设置好后，可以通过go env 命令来进行测试。

C:\\Users\\Administrator\>go env\
set GO111MODULE=\
set GOARCH=amd64\
set GOBIN=\
set GOCACHE=C:\\Users\\Administrator\\AppData\\Local\\go-build\
set GOENV=C:\\Users\\Administrator\\AppData\\Roaming\\go\\env\
set GOEXE=.exe\
set GOFLAGS=\
set GOHOSTARCH=amd64\
set GOHOSTOS=windows\
set GONOPROXY=\
set GONOSUMDB=\
set GOOS=windows\
set GOPATH=C:\\Users\\Administrator\\go\
set GOPRIVATE=\
set GOPROXY=https://proxy.golang.org,direct\
set GOROOT=c:\\go\
. . .

上面只显示了部分结果，如果执行go
env 命令后，出现类似上面的结果，说明我们的Go开发包已经安装成功了。\
\
如果大家想了解更多关于 GOPATH 的介绍可以参考《GOPATH详解》一节。

## 1.13+1 Go语言(Golang)安装下载配置及debug调试

大G_code 已于 2023-01-27 10:07:13 修改

原文链接：<https://blog.csdn.net/amumu_coding/article/details/128764796>

文章标签： golang 后端 vscode

**1.Golang快速开始**

与Java类似，Go语言使用前也需要安装开发环境，并配置环境变量。下面以Windows平台为例，演示整体流程。

**2.下载安装Golang安装包**

官方网站可能访问不到
<https://golang.org/>，可以访问国内镜像网站下载Go安装包：

<https://studygolang.com/dl>

<https://mirrors.nju.edu.cn/>

因为Go语言一直的迭代，入门时尽量选择较新的版本，如1.16之后的版本，下载时选择windows-amd64的安装版，如go1.18.10.windows-amd64.msi。

安装过程非常简单，除了选择一下安装路径，其他的点击next就行。

**3.环境变量配置**

Go安装后，开始配置操作系统的环境变量

右击此电脑--\>属性--\>高级系统设置--\>环境变量

系统变量添加GOROOT和GOPATH，GOROOT为Go安装目录，GOPATH为Go语言工作目录，可参照下方配置，具体的路径根据实际配置。最后在Path变量下添加%GOROOT%\\bin。

GOROOT D:\\softrun\\Go GOPATH D:\\softrun\\GOPATH

用户变量也添加GOPATH。

GOPATH D:\\softrun\\GOPATH

环境变量配置好后，打开cmd，输入go version可以查看go的版本信息

**3.1go env 配置**

最后还有一些go的env变量需要配置：

GO111MODULE：包管理模式，auto即可，可以同时使用MODULE和GOPATH模式（非mod项目也可以build
解决 go: go.mod file not found in current directory or any parent
directory）。

GOPROXY：配置包代理镜像，使用国内的镜像源代替

GONOPROXY/GONOSUMDB：配置私有模块，公司内根据需要配置

打开cmd，尝试阶段配置前两个即可

go env -w GO111MODULE=auto go env -w GOPROXY=https://goproxy.cn,direct
#公司内根据需要配置 go env -w GONOPROXY=xxx.xxx go env -w
GONOSUMDB=xxx.xxx

go env 可查看目前的env变量配置

## 1.14 在Linux上安装Go语言开发包

前面我们介绍了在 Windows 系统上来搭建Go语言开发包，本节将为大家讲解在
Linux
平台安装Go语言开发包，大家可以在Go语言官网找到对应的安装包（https://golang.google.cn/dl/），但是先不要急着下载。

提示：阅读本节需要对 Linux
系统及常用的命令有一定的了解，感兴趣的读者可以通过阅读《Linux入门教程》来了解更多
Linux 相关的知识。

![IMG_256](media/image15.png){width="8.333333333333334in"
height="3.0520833333333335in"}

注意：开发包有 32 位和 64
位两个版本，需要根据读者电脑的情况选择不同的版本。

接下来将带领大家一步步的完成安装过程。

### 1.14.1安装Go语言开发包

首先，复制Go语言开发包的下载链接（https://dl.google.com/go/go1.13.4.linux-amd64.tar.gz）。然后，在终端使用cd 命令进入你用来存放安装包的目录中（这里使用的是
/usr/local/ 目录，读者也可以使用其它目录）。

root@ububtu:\~# cd /usr/local/\
root@ububtu:/usr/local#

使用wget 命令下载Go语言开发包，如下所示。

root@ububtu:/usr/local# wget
https://dl.google.com/go/go1.13.4.linux-amd64.tar.gz\
\--2019-11-06 10:47:23\-- 
https://dl.google.com/go/go1.13.4.linux-amd64.tar.gz\
正在解析主机 dl.google.com (dl.google.com)\... 203.208.39.196,
203.208.39.193, 203.208.39.200, \...\
正在连接 dl.google.com (dl.google.com)\|203.208.39.196\|:443\...
已连接。\
已发出 HTTP 请求，正在等待回应\... 200 OK\
长度： 120054682 (114M) \[application/octet-stream\]\
正在保存至: "go1.13.4.linux-amd64.tar.gz"\
\
go1.13.4.linux  43%  49.44M  3.56MB/s    剩余 16s        
\^go1.13.4.linux 100% 114.49M  4.73MB/s    用时 31s        \
\
2019-11-06 10:47:56 (3.67 MB/s) - 已保存 "go1.13.4.linux-amd64.tar.gz"
\[120054682/120054682\])

使用tar 命令解压刚刚下载的Go语言开发包。

root@ububtu:/usr/local# tar -C /usr/local -xzf
go1.13.4.linux-amd64.tar.gz 

解压成功后会在当前目录下新增一个 go
目录，至此我们的Go语言开发包就安装完成了，使用cd 命令进入该目录，然后执行bin/go
version 命令就可以查看当前Go语言的版本了。

root@ububtu:/usr/local/go# bin/go version\
go version go1.13.4 linux/amd64

### 1.14.2配置环境变量

我们需要配置 2 个环境变量分别是 GOROOT 和 PATH。

-   GOROOT 的值应该为Go语言的当前安装目录：export GOROOT=/usr/local/go

-   PATH 为了方便使用Go语言命令和 Go
    程序的可执行文件，需要追加其值：export
    PATH=\$PATH:\$GOROOT/bin:\$GOBIN

为了方便以后的使用，需要把这几个环境变量添加 profile
文件中（\~/.bash_profile 或
/etc/profile）。如果是单用户使用，可以将环境变量添加在 home 目录下的
bash_profile 文件中，如果是多用户使用，需要添加在 /etc/profile
文件。（推荐大家在 /etc/profile 文件中设置环境变量）\
\
使用vi /etc/profile 命令打开 profile 文件，并将环境变量添加到文件末尾。

![IMG_257](media/image16.png){width="5.635416666666667in"
height="1.5625in"}

添加完成后使用:wq 命令保存并退出。\
\
然后，使用 source
/etc/profile 命令使配置文件生效，现在就可以在任意目录使用Go语言命令了。

### 1.14.3验证安装

在任意目录下使用终端执行 go env
命令，输出如下结果说明Go语言开发包已经安装成功。

root@ububtu:\~\$ go env\
GO111MODULE=\"\"\
GOARCH=\"amd64\"\
GOBIN=\"\"\
GOCACHE=\"/home/feng/.cache/go-build\"\
GOENV=\"/home/feng/.config/go/env\"\
GOEXE=\"\"\
GOFLAGS=\"\"\
GOHOSTARCH=\"amd64\"\
GOHOSTOS=\"linux\"\
GONOPROXY=\"\"\
GONOSUMDB=\"\"\
GOOS=\"linux\"\
GOPATH=\"/home/feng/go\"\
GOPRIVATE=\"\"\
GOPROXY=\"https://proxy.golang.org,direct\"\
GOROOT=\"/usr/local/go\"\
GOSUMDB=\"sum.golang.org\"\
GOTMPDIR=\"\"\
. . .

提示：上面只显示了部分结果。

## 1.14+1 Linux下 Go语言环境安装

linux下使用Go语言开发时，需要安装Go语言环境。安装主要过程为下载Go语言安装包，解压到工作目录中，配置环境并检验是否安装成功。

**1，下载Go语言安装包**

安装包下载地址：

[https://golang.google.cn/dl/](https://golang.google.cn/dl).（Go语言英文网)

<https://studygolang.com/dl>. （Go语言中文网)

**2，将二进制包解压至 /usr/local目录**

// 解压安装包

tar -C /usr/local -xzf go1.13.4.linux-amd64.tar.gz

**3，配置环境变量**

运行命令 vim /etc/profile，在文件中添加一下环境变量

export GOROOT=/usr/local/go

export GOPATH=\$HOME/go

export PATH=\$PATH:\$GOROOT/bin:\$GOPATH/bin

保存profile文件并运行命令 source /etc/profile，重新加载环境配置

\## 注： my setting：

export GOROOT=/home/abel123/go

export GOPATH=/home/abel123/gopath

export PATH=\$PATH:\$GOROOT/bin:\$GOPATH/bin

**4，运行命令检验是否安装成功**

// 方法1：

go version

// 方法2：或编辑test.go 文件，进行检验

package main

import \"fmt\"

func main() {

fmt.Println(\"Hello, World!\")

}

[go run test.go]{.mark}

## 1.15 [在Mac OS上安装Go语言开发包](http://c.biancheng.net/view/3994.html)

前面我们介绍了在 Windows 系统上来搭建Go语言开发包，本节将为大家讲解在
Linux
平台安装Go语言开发包，大家可以在Go语言官网找到对应的安装包（https://golang.google.cn/dl/），但是先不要急着下载。

提示：阅读本节需要对 Linux
系统及常用的命令有一定的了解，感兴趣的读者可以通过阅读《Linux入门教程》来了解更多
Linux 相关的知识。

![IMG_256](media/image15.png){width="5.356944444444444in"
height="1.9618055555555556in"}

注意：开发包有 32 位和 64
位两个版本，需要根据读者电脑的情况选择不同的版本。

接下来将带领大家一步步的完成安装过程。

### 1.15.1安装Go语言开发包

首先，复制Go语言开发包的下载链接（https://dl.google.com/go/go1.13.4.linux-amd64.tar.gz）。然后，在终端使用cd 命令进入你用来存放安装包的目录中（这里使用的是
/usr/local/ 目录，读者也可以使用其它目录）。

root@ububtu:\~# cd /usr/local/\
root@ububtu:/usr/local#

使用wget 命令下载Go语言开发包，如下所示。

root@ububtu:/usr/local# wget
https://dl.google.com/go/go1.13.4.linux-amd64.tar.gz\
\--2019-11-06 10:47:23\-- 
https://dl.google.com/go/go1.13.4.linux-amd64.tar.gz\
正在解析主机 dl.google.com (dl.google.com)\... 203.208.39.196,
203.208.39.193, 203.208.39.200, \...\
正在连接 dl.google.com (dl.google.com)\|203.208.39.196\|:443\...
已连接。\
已发出 HTTP 请求，正在等待回应\... 200 OK\
长度： 120054682 (114M) \[application/octet-stream\]\
正在保存至: "go1.13.4.linux-amd64.tar.gz"\
\
go1.13.4.linux  43%  49.44M  3.56MB/s    剩余 16s        
\^go1.13.4.linux 100% 114.49M  4.73MB/s    用时 31s        \
\
2019-11-06 10:47:56 (3.67 MB/s) - 已保存 "go1.13.4.linux-amd64.tar.gz"
\[120054682/120054682\])

使用tar 命令解压刚刚下载的Go语言开发包。

root@ububtu:/usr/local# tar -C /usr/local -xzf
go1.13.4.linux-amd64.tar.gz 

解压成功后会在当前目录下新增一个 go
目录，至此我们的Go语言开发包就安装完成了，使用cd 命令进入该目录，然后执行bin/go
version 命令就可以查看当前Go语言的版本了。

root@ububtu:/usr/local/go# bin/go version\
go version go1.13.4 linux/amd64

### 1.15.2配置环境变量

我们需要配置 2 个环境变量分别是 GOROOT 和 PATH。

-   GOROOT 的值应该为Go语言的当前安装目录：export GOROOT=/usr/local/go

-   PATH 为了方便使用Go语言命令和 Go
    程序的可执行文件，需要追加其值：export
    PATH=\$PATH:\$GOROOT/bin:\$GOBIN

为了方便以后的使用，需要把这几个环境变量添加 profile
文件中（\~/.bash_profile 或
/etc/profile）。如果是单用户使用，可以将环境变量添加在 home 目录下的
bash_profile 文件中，如果是多用户使用，需要添加在 /etc/profile
文件。（推荐大家在 /etc/profile 文件中设置环境变量）\
\
使用vi /etc/profile 命令打开 profile 文件，并将环境变量添加到文件末尾。

![IMG_257](media/image16.png){width="5.635416666666667in"
height="1.5625in"}

添加完成后使用:wq 命令保存并退出。\
\
然后，使用 source
/etc/profile 命令使配置文件生效，现在就可以在任意目录使用Go语言命令了。

### 1.15.3验证安装

在任意目录下使用终端执行 go env
命令，输出如下结果说明Go语言开发包已经安装成功。

root@ububtu:\~\$ go env\
GO111MODULE=\"\"\
GOARCH=\"amd64\"\
GOBIN=\"\"\
GOCACHE=\"/home/feng/.cache/go-build\"\
GOENV=\"/home/feng/.config/go/env\"\
GOEXE=\"\"\
GOFLAGS=\"\"\
GOHOSTARCH=\"amd64\"\
GOHOSTOS=\"linux\"\
GONOPROXY=\"\"\
GONOSUMDB=\"\"\
GOOS=\"linux\"\
GOPATH=\"/home/feng/go\"\
GOPRIVATE=\"\"\
GOPROXY=\"https://proxy.golang.org,direct\"\
GOROOT=\"/usr/local/go\"\
GOSUMDB=\"sum.golang.org\"\
GOTMPDIR=\"\"\
. . .

提示：上面只显示了部分结果。

## 1.16 [Go语言集成开发环境](http://c.biancheng.net/view/3995.html)

前面我们介绍了Go语言的安装，本节我们来为大家介绍几款强大的Go语言集成开发环境（Integrated
Development Environment，IDE）和编辑器。\
\
如何挑选合适的编辑器或集成开发环境呢？下面列举了一些Go语言集成开发环境或编辑器应该具备的特性：

-   语法高亮是必不可少的功能，这也是为什么每个开发工具都提供配置文件来实现自定义配置的原因。

-   拥有较好的项目文件纵览和导航能力，可以同时编辑多个源文件并设置书签，能够匹配括号，能够跳转到某个函数或类型的定义部分。

-   完美的查找和替换功能，替换之前最好还能预览结果。

-   当有编译错误时，双击错误提示可以跳转到发生错误的位置。

-   跨平台，能够在 Linux、Mac OS X 和 Windows
    下工作，这样就可以专注于一个开发环境。

-   能够通过插件架构来轻易扩展和替换某个功能。

-   拥有断点、检查变量值、单步执行、逐过程执行标识库中代码的能力。

-   能够方便的存取最近使用过的文件或项目。

-   拥有对包、类型、变量、函数和方法的智能代码补全的功能。

-   能够方便地在不同的 Go 环境之间切换。

-   针对一些特定的项目有项目模板，如：Web 应用，App Engine
    项目，从而能够更快地开始开发工作。

下面为大家推荐几款常用的适用于Go语言的编辑器或集成开发环境。

#### 1) Goland

Goland 是由 JetBrains 公司开发的一个新的商业 IDE，旨在为 Go
开发者提供的一个符合人体工程学的新的商业 IDE。Goland 整合了 IntelliJ
平台（一个用于 java
语言开发的集成环境，也可用于其他开发语言），提供了针对Go语言的编码辅助和工具集成。

![IMG_256](media/image17.png){width="5.902777777777778in"
height="3.3097222222222222in"}

关于 Goland 的详细使用说明请参考《Goland 2019下载和安装》一节。

#### 2) LiteIDE

LiteIDE是一款专门针对 Go 开发的集成开发环境，在编辑、编译和运行 Go
程序和项目方面都有非常好的支持。同时还包括了对源代码的抽象语法树视图和一些内置工具（此开发环境由国人
vfc 大叔开发）。\
\
LiteIDE 是一款非常好用的轻量级 Go 集成开发环境（基于 QT、Kate 和
SciTE），包含了跨平台开发及其它必要的特性，对代码编写、自动补全和运行调试都有极佳的支持。它采用了
Go 项目的概念来对项目文件进行浏览和管理，它还支持在各个 Go
开发环境之间随意切换以及交叉编译的功能。\
\
同时，它具备了抽象语法树视图的功能，可以清楚地纵览项目中的常量、变量、函数、不同类型以及他们的属性和方法。

![IMG_257](media/image18.png){width="5.683333333333334in"
height="3.566666666666667in"}

关于 LiteIDE 的安装和使用大家可以参考《LiteIDE搭建Go语言开发环境》一节。

#### 3) Sublime Text

一个革命性的跨平台（Linux、Mac OS
X、Windows）文本编辑器，它支持编写非常多的编程语言代码。对于 Go
而言，它有一个插件叫做 GoSublime 来支持代码补全和代码模版。

#### 4) GoClipse

是一款 Eclipse IDE 的插件，拥有非常多的特性以及通过 GoCode
来实现代码补全功能。其依附于著名的 Eclipse
这个大型开发环境，虽然需要安装 JVM 运行环境，但却可以很容易地享有
Eclipse
本身所具有的诸多功能。这是一个非常好的编辑器，完善的代码补全、抽象语法树视图、项目管理和程序调试功能。

![IMG_258](media/image19.png){width="5.622222222222222in"
height="3.036111111111111in"}

如果你对集成开发环境都不是很熟悉，那就使用 LiteIDE 吧，另外使用 GoClipse
或者 IntelliJ Idea Plugin 也是不错的选择。\
\
代码补全一般都是通过内置 GoCode
实现的（如：LiteIDE、GoClipse），如果需要手动安装
GoCode，在命令行输入指令 go get -u
github.com/nsf/gocode 即可（务必事先配置好 Go 环境变量） 。

#### 5) Visual Studio Code（简称VS Code）

是一款由微软公司开发的，能运行在 Mac OS X、Windows 和 Linux
上的跨平台开源代码编辑器。\
\
VS Code 使用 JSON
格式的配置文件进行所有功能和特性的配置，同时它还可以通过扩展程序为编辑器实现编程语言高亮、参数提示、编译、调试、文档生成等各种功能。

## 1.17 [Go语言工程结构详述](http://c.biancheng.net/view/4773.html)

一般的编程语言往往对工程（项目）的目录结构是没有什么规定的，但是Go语言却在这方面做了相关规定，本节我们就来聊聊Go语言在工程结构方面的有关知识。\
\
我们前面讲搭建Go语言开发环境时提到的环境变量
GOPATH，项目的构建主要是靠它来实现的。这么说吧，如果想要构建一个项目，就需要将这个项目的目录添加到
GOPATH 中，多个项目之间可以使用;分隔。\
\
如果不配置
GOPATH，即使处于同一目录，代码之间也无法通过绝对路径相互调用。

### 1.17.1目录结构

一个Go语言项目的目录一般包含以下三个子目录：

-   src 目录：放置项目和库的源文件；

-   pkg 目录：放置编译后生成的包/库的归档文件；

-   bin 目录：放置编译后生成的可执行文件。

三个目录中我们需要重点关注的是 src
目录，其他两个目录了解即可，下面来分别介绍一下这三个目录。

#### src 目录

用于以包（package）的形式组织并存放 Go 源文件，这里的包与 src
下的每个子目录是一一对应。例如，若一个源文件被声明属于 log
包，那么它就应当保存在 src/log 目录中。\
\
并不是说 src 目录下不能存放 Go 源文件，一般在测试或演示的时候也可以把 Go
源文件直接放在 src 目录下，但是这么做的话就只能声明该源文件属于 main
包了。正常开发中还是建议大家把 Go 源文件放入特定的目录中。\
\
包是Go语言管理代码的重要机制，其作用类似于Java中的 package 和
C/C++ 的头文件。Go 源文件中第一段有效代码必须是package
\<包名\> 的形式，如 package hello。\
\
另外需要注意的是，Go语言会把通过go get 命令获取到的库源文件下载到 src
目录下对应的文件夹当中。

#### pkg 目录

用于存放通过go
install 命令安装某个包后的归档文件。归档文件是指那些名称以".a"结尾的文件。\
\
该目录与 GOROOT 目录（也就是Go语言的安装目录）下的 pkg
目录功能类似，区别在于这里的 pkg 目录专门用来存放项目代码的归档文件。\
\
编译和安装项目代码的过程一般会以代码包为单位进行，比如 log
包被编译安装后，将生成一个名为 log.a 的归档文件，并存放在当前项目的 pkg
目录下。

#### bin 目录

与 pkg 目录类似，在通过go install 命令完成安装后，保存由 Go
命令源文件生成的可执行文件。在类 Unix
操作系统下，这个可执行文件的名称与命令源文件的文件名相同。而在 Windows
操作系统下，这个可执行文件的名称则是命令源文件的文件名加 .exe 后缀。

### 1.17.2源文件

上面我们提到了命令源文件和库源文件，它们到底是什么呢？

-   命令源文件：如果一个 Go 源文件被声明属于 main 包，并且该文件中包含
    main
    函数，则它就是命令源码文件。命令源文件属于程序的入口，可以通过Go语言的go
    run 命令运行或者通过go build 命令生成可执行文件。

-   库源文件：库源文件则是指存在于某个包中的普通源文件，并且库源文件中不包含
    main 函数。

不管是命令源文件还是库源文件，在同一个目录下的所有源文件，其所属包的名称必须一致的。

## 1.18Go语言依赖管理

早期的Go语言被很多开发者所吐槽的一个问题就是没有依赖包的管理，不过随着版本的不断更迭，Go语言依赖管理方面也在不断的完善。

### 1.18.1为什么需要依赖管理

最初的时候Go语言所依赖的所有的第三方包都放在 GOPATH
目录下面，这就导致了同一个包只能保存一个版本的代码，如果不同的项目依赖同一个第三方的包的不同版本，应该怎么解决呢？

### 1.18.2godep

godep 是一个Go语言官方提供的通过 vender
模式来管理第三方依赖的工具，类似的还有由社区维护的准官方包管理工具
dep。\
\
Go语言从 1.5 版本开始开始引入 vendor 模式，如果项目目录下有 vendor
目录，那么Go语言编译器会优先使用 vendor 内的包进行编译、测试等。

#### 安装godep工具

我们可以通过go get 命令来获取 godep 工具。

go get github.com/tools/godep

命令执行成功后会将 godep 工具的源码下载到 GOPATH 的 src
目录下对应的文件夹中，同时还会在 GOPATH 的 bin 目录下生成一个名为
godep.exe 的可执行文件，如下图所示。

![IMG_256](media/image20.png){width="7.6875in"
height="2.8333333333333335in"}

为了方便使用 godep 工具，我们需要将存放 godep.exe
文件的目录添加到环境变量 PATH
中。在系统变量中找到并选中"Path"一行，点击"编辑"按钮，在新弹出的窗口中点击"新建"，然后在最下面一行中填入对应的目录信息。确认无误后点击"确定"。

![IMG_257](media/image21.png){width="11.645833333333334in"
height="6.53125in"}

环境变量设置的打开方式我们在《安装Go语言开发包》一节中已经介绍过了，这里不再赘述。

#### godep工具的基本命令

完成上面的操作后，我们就可以在命令行窗口（CMD）中使用 godep
工具了，godep 支持的命令如下表所示：

  ------------------ ----------------------------------------------------
  **命令**           **作用**

  godep save         将依赖包的信息保存到 Godeps.json 文件中

  godep go           使用保存的依赖项运行 go 工具

  godep get          下载并安装指定的包

  godep path         打印依赖的 GOPATH 路径

  godep restore      在 GOPATH 中拉取依赖的版本

  godep update       更新选定的包或 go 版本

  godep diff         显示当前和以前保存的依赖项集之间的差异

  godep version      查看版本信息
  ------------------ ----------------------------------------------------

使用godep help \[命令名称\]可以查看命令的帮助信息，如下所示。

C:\\Users\\Administrator\>godep help go\
Args: godep go \[-v\] \[-d\] command \[arguments\]\
\
Go runs the go tool with a modified GOPATH giving access to\
dependencies saved in Godeps.\
\
Any go tool command can run this way, but \"godep go get\"\
is unnecessary and has been disabled. Instead, use\
\"godep go install\".\
\
If -v is given, verbose output is enabled.\
\
If -d is given, debug output is enabled (you probably don\'t want this,
see -v).

#### 使用godep工具

执行godep save 命令，会在当前目录中创建 Godeps 和 vender
两个文件夹。Godeps 文件夹下会生成一个 Godeps.json
文件，用来记录项目中所依赖的包信息；vender
目录则是用来保存当前项目所依赖的所有第三方包。

![IMG_258](media/image22.png){width="8.333333333333334in"
height="4.479166666666667in"}

生成的 Godeps.json 文件的结构如下所示：

{\
    \"ImportPath\": \"main\",\
    \"GoVersion\": \"go1.13\",\
    \"GodepVersion\": \"v80\",\
    \"Deps\": \[\
        {\
            \"ImportPath\": \"github.com/go-gomail/gomail\",\
            \"Comment\": \"2.0.0-23-g81ebce5\",\
            \"Rev\": \"81ebce5c23dfd25c6c67194b37d3dd3f338c98b1\"\
        }\
    \]\
}

其中，"ImportPath"为项目的路径信息，"GoVersion"为Go语言的版本号，"GodepVersion"为
godep 工具的版本号，"Deps"为当前依赖包的路径、版本号信息等等。

提示：当引用的第三方包要升级时，只需要修改 Godep.json
里面的依赖包的版本号，然后再次执行 godep save 命令即可。

godep
工具的主要功能就是控制Go语言程序编译时依赖包搜索路径的优先级。例如查找项目的某个依赖包，首先会在项目根目录下的
vender 文件夹中查找，如果没有找到就会去 GOAPTH/src 目录下查找。

### 1.18.3go module

go module 是Go语言从 1.11 版本之后官方推出的版本管理工具，并且从 Go1.13
版本开始，go module 成为了Go语言默认的依赖管理工具。

#### GO111MODULE

在Go语言 1.12 版本之前，要启用 go module 工具首先要设置环境变量
GO111MODULE，不过在Go语言 1.13 及以后的版本则不再需要设置环境变量。通过
GO111MODULE 可以开启或关闭 go module 工具。

-   GO111MODULE=off 禁用 go module，编译时会从 GOPATH 和 vendor
    文件夹中查找包。

-   GO111MODULE=on 启用 go module，编译时会忽略 GOPATH 和 vendor
    文件夹，只根据 go.mod 下载依赖。

-   GO111MODULE=auto（默认值），当项目在 GOPATH/src
    目录之外，并且项目根目录有 go.mod 文件时，开启 go module。

Windows 下开启 GO111MODULE 的命令为：

set GO111MODULE=on 或者 set GO111MODULE=auto

MacOS 或者 Linux 下开启 GO111MODULE 的命令为：

export GO111MODULE=on 或者 export GO111MODULE=auto

在开启 GO111MODULE 之后就可以使用 go module
工具了，也就是说在以后的开发中就没有必要在 GOPATH
中创建项目了，并且还能够很好的管理项目依赖的第三方包信息。\
\
使用 go module 的go mod init 命令后会在当前目录下生成一个 go. mod
文件，并且在编译/运行当前目录下代码或者使用go
get 命令的时候会在当前目录下生成一个 go.sun 文件。

![IMG_259](media/image23.png){width="6.118055555555555in"
height="2.548611111111111in"}

go.mod 文件记录了项目所有的依赖信息，其结构大致如下：

module main.go\
\
go 1.13\
\
require (\
    github.com/astaxie/beego v1.12.0\
    github.com/shiena/ansicolor v0.0.0-20151119151921-a422bbe96644 //
indirect\
)

其中，module 为 go.mod 文件所属的包，require
为项目所依赖的包及版本号，indirect 表示间接引用。\
\
go.sum 文件则是用来记录每个依赖包的版本及哈希值，如下所示。

github.com/Knetic/govaluate v3.0.0+incompatible/go.mod
h1:r7JcOSlj0wfOMncg0iLm8Leh48TZaKVeNIfJntJ2wa0=\
github.com/OwnLocal/goes v1.0.0/go.mod
h1:8rIFjBGTue3lCU0wplczcUgt9Gxgrkkrw7etMIcn8TM=\
github.com/astaxie/beego v1.12.0
h1:MRhVoeeye5N+Flul5PoVfD9CslfdoH+xqC/xvSQ5u2Y=\
github.com/astaxie/beego v1.12.0/go.mod
h1:fysx+LZNZKnvh4GED/xND7jWtjCR6HzydR2Hh2Im57o=

常用的 go mod 命令如下表所示：

  ------------------ ----------------------------------------------------
  **命令**           **作用**

  go mod download    下载依赖包到本地（默认为 GOPATH/pkg/mod 目录）

  go mod edit        编辑 go.mod 文件

  go mod graph       打印模块依赖图

  go mod init        初始化当前文件夹，创建 go.mod 文件

  go mod tidy        增加缺少的包，删除无用的包

  go mod vendor      将依赖复制到 vendor 目录下

  go mod verify      校验依赖

  go mod why         解释为什么需要依赖
  ------------------ ----------------------------------------------------

#### GOPROXY

proxy
顾名思义就是代理服务器的意思。大家都知道，国内的网络有防火墙的存在，这导致有些Go语言的第三方包我们无法直接通过go
get 命令获取。GOPROXY
是Go语言官方提供的一种通过中间代理商来为用户提供包下载服务的方式。要使用
GOPROXY 只需要设置环境变量 GOPROXY 即可。\
\
目前公开的代理服务器的地址有：

-   goproxy.io

-   goproxy.cn：（推荐）由国内的七牛云提供。

Windows 下设置 GOPROXY 的命令为：

go env -w GOPROXY=https://goproxy.cn,direct

MacOS 或 Linux 下设置 GOPROXY 的命令为：

export GOPROXY=https://goproxy.cn

Go语言在 1.13 版本之后 GOPROXY 默认值为
https://proxy.golang.org，在国内可能会存在下载慢或者无法访问的情况，所以十分建议大家将
GOPROXY 设置为国内的 goproxy.cn。

#### 使用go get命令下载指定版本的依赖包

执行go get 命令，在下载依赖包的同时还可以指定依赖包的版本。

-   运行go get -u命令会将项目中的包升级到最新的次要版本或者修订版本；

-   运行go get -u=patch命令会将项目中的包升级到最新的修订版本；

-   运行go get
    \[包名\]@\[版本号\]命令会下载对应包的指定版本或者将对应包升级到指定的版本。

提示：go get \[包名\]@\[版本号\]命令中版本号可以是 x.y.z 的形式，例如 go
get foo@v1.2.3，也可以是 git 上的分支或 tag，例如 go get
foo@master，还可以是 git 提交时的哈希值，例如 go get foo@e3702bed2。

## 1.18+1 Go语言依赖管理

-   依赖的概念：编译程序不可能所有东西都自己写，我们会大量使用一些第三方的库来引入自己的代码。

-   依赖管理的三个阶段：GOPATH、GOVENDOR、go mod

-   GOPATH和GOVENDOR正在向go mod迁移

### 1.18.1 GOPATH和GOVENDOR工作模式

### 1.18.1.1 GOPATH工作模式

GOPATH工作模式就是把所有依赖包都放在GOPATH下的src中。

GOPATH依赖管理时依赖所在的目录位置：

![IMG_256](media/image24.png){width="5.322916666666667in"
height="0.59375in"}

此工作模式系统会去GOPATH和GOROOT中寻找引入的第三方库。

**GOPATH工作模式的弊端：**

1.  无版本控制概念

2.  无法同步一致第三方版本号

3.  无法指定当前项目引用的第三方版本号

### 1.18.1.2 GOVENDOR工作模式

GOPATH工作模式有一个问题，当src下存在多个项目时，不同项目是由不同的人编写，在编写时所采用的依赖包版本可能不同，这时GOVENDOR工作模式解决了这个问题。

GOVENDOR工作模式是指在每个项目下创建vendor文件夹用来存放不同版本的依赖包，这样每个项目都会使用自己vendor下的依赖包，就解决了每个项目使用的依赖包版本不同的问题。

示例：

GOPATH下的src文件下有project1和project2两个项目，同时还有含有依赖包zap的go.uber.org目录

![IMG_257](media/image25.png){width="1.7548611111111112in"
height="2.3645833333333335in"}

但这两个项目使用的依赖包版本不一样，此时在两个项目下各自创建vendor文件夹，把各自使用的不同版本的依赖包放入其中即可：

![IMG_258](media/image26.png){width="2.8715277777777777in"
height="3.283333333333333in"}

GOVENDOR工作模式依赖所在的目录位置：

![IMG_259](media/image27.png){width="6.8125in"
height="0.6145833333333334in"}

可以看出系统会去vendor目录中去寻找依赖。

此工作模式系统会去项目目录下的vendor、GOPATH、GOROOT中寻找引入的第三方库。

**【小结】GOVENDOR**

-   每个项目都有自己的vendor目录用来存放第三方库

-   因此诞生了很多第三方依赖管理工具用来对每个项目的vendor目录进行管理，如glide、dep、go
    dep\...

### 1.18.2 go mod的使用

-   什么是Go Modules？

Go
modules是Go语言的依赖解决方案，发布于Go1.11，成长于Go1.12，丰富于Go1.13，正式于Go1.14推荐在生产上使用。

-   Go Modules解决了什么问题？

1.  Go语言长久以来的依赖管理问题

2.  "淘汰"现有的GOPATH使用模式

3.  统一社区中的其他的依赖管理工具（提供迁移功能）

#### 1.18.2.1 go mod命令

  -----------------------------------------------------------------------
  **命令**                  **作用**
  ------------------------- ---------------------------------------------
  go mod init               生成go.mod文件

  go mod download           下载go.mod文件中指明的所有依赖

  go mod tidy               整理现有的依赖

  go mod graph              查看现有的依赖结构

  go mod edit               编辑go.mod文件

  go mod vendor             导出项目所有的依赖到vendor目录

  go mod verify             校验一个模块是否被篡改过

  go mod why                查看为什么需要依赖某模块
  -----------------------------------------------------------------------

#### 1.18.2.2 go mod环境变量

GO111MODULE和GOPROXY为常用环境变量。

环境变量可以通过go env命令来进行查看

\$ go env

GO111MODULE=\"auto\"

GOPROXY=\"http://proxy.golang.org,direct\"

GONOPROXY=\"\"

GOSUMDB=\"sum.golang.org\"

GONOSUMDB=\"\"

GOPRIVATE=\"\"\...

##### 1.18.2.2 .1 GO111MODULE

Go语言提供了GO111MODULE这个环境变量来作为Go
Modules的开关，其允许设置以下参数：

-   auto：只要项目包含了go.mod文件的话启用Go
    Modules，目前在Go1.11至Go1.14仍是默认值。

-   on：启用Go Modules，推荐设置，将会是未来版本中的默认值。

-   off：禁用Go Modules，不推荐设置。

设置GO111MODULE状态命令行：

\$ go env -w GO111MODULE=on

##### 1.18.2.2.2 GOPROXY

这个环境变量主要是用于设置Go模块代理（Go module
proxy），其作用是用于使Go在后续拉取模块版本时直接通过镜像站点来快速拉取。**用来设置从哪个第三方托管平台下载依赖包，设置好后可以通过**import**来设置路径，可以自动去下载依赖包。**

GOPROXY的默认值是：http://proxy.golang.org,direct

proxy.golang.org国内访问不了，需要设置国内的代理。

-   阿里云 http://mirrors.aliyun.com/goproxy/

-   七牛云 http://goproxy.cn,direct

如：

\$ go env -w GOPROXYU=http://goproxy.cn,direct

GOPROXY的值是一个以英文逗号" ,
"分割的Go模块代理列表，允许设置多个模块代理，假设你不想使用，也可以将其设置为"
off "，这将会禁止Go在后续操作中使用任何Go模块代理。

如：

\$ go env -w
GOPROXYU=http://goproxy.cn,http://mirrors.aliyun.com/goproxy/,direct

> direct

而在刚刚设置的值中，我们可以发现值列表中有"direct"标识，它又有什么作用呢？

实际上"direct"是一个特殊指示符，用于指示Go回源到模块版本的源地址去抓取（比如GitHub等），场景如下：当值列表中上一个Go模块代理返回404或410错误时，Go自动尝试列表中的下一个，遇见"direct"时回源，也就是回到源地址去抓取，而遇见EOF时终止并抛出类似"invalid
version: unknowrevision\..."的错误。

##### 1.18.2.2.3 GOSUMDB

它的值是一个GO checksum
database，用于在拉取模块版本时（无论是从源站拉去还是通过Go module
proxy拉取）保证拉取到的模块版本数据未经过篡改，若发现不一致，也就是可能存在篡改，将会立即终止。

GOSUMDB的默认值为：sum.golang.org，在国内也是无法访问的，但是GOSUMDB可以被Go模块代理所代理（详见：Proxying
a Checksum Database）。

因此我们可以通过设置GOPROXY来解决，而先前我们所设置的模块代理goproxy.cn就能支持代理sum.golang.org，所以这一个问在设置GOPROXY后，你可以不需要过度关心。

另外若对GOSUMDB的值有自定义需求，其支持如下格式：

-   格式1：\<SUMDB_NAME\>+\<PUBLIC_KEY\>

-   格式2：\<SUMDB_NAME\>+\<PUBLIC_KEY\>\<SUMDB_URL\>

也可以将其设置为"off"，也就是禁止Go在后续操作中校验模块版本。

##### 1.18.2.2.4 GONOPROXY/GONOSUMDB/GOPRIVATE

这三个环境变量都是用在当前项目依赖了私有模块，例如像是你公司的私有git仓库，又或是github中的私有库，都是属于私有模块，都是要进行设置的，否则会拉取失败。

更细致来讲，就是依赖了由GOPROXY指定的Go模块代理或由GOSUMDB指定Go
checksum database都无法访问到的模块的场景。

如果一个项目是私有项目，可以设置其为GOPRIVATE，表示其不会再通过GOPROXY下载和校验。

而一般建议直接设置GOPRIVATE，它的值将作为GONOPROXY和GONOSUMDB的默认值。

并且它们的值都是一个以英文逗号" ,
"分割的模块路径前缀，也就是可以设置多个，例如：

\$ go env -w GOPRIVATE=\"git.example.com,github.com/eddycjy/mquote\"

设置后，前缀为git.xxx.com和github.com/eddycjy/mquote的模块都会被认为是私有模块。

如果不想每次都重新设置，我们也可以利用通配符，例如：

\$ go env -w GOPRIVATE=\"\*.example.com\"

这样设置的话，所有模块路径为example.com的子域名（例如：git.example.com）都将不经过Go
module proxy和Go checksum database，需要注意的是不包括example.com本身。

**总览：**

![IMG_260](media/image28.png){width="5.958333333333333in"
height="2.859722222222222in"}

go mod依赖管理方式依赖所在的目录位置：

![IMG_261](media/image29.png){width="5.478472222222222in"
height="0.3020833333333333in"}

**【小结】go mod依赖管理方式**

-   由go命令统一管理，用户不必关心目录结构

-   初始化：go mod init

-   增加依赖：go get，或者直接在程序中写代码import

-   更新依赖：go get \[@v\...\]（不加版本号就默认是最新的版本），go mod
    tidy用来整理去除多余的依赖

-   将项目迁移到go mod：go mod init，go build ./\...

## 1.18+2 Go语言基础知识4------依赖管理

polarday. 已于 2022-11-18 09:55:13 修改

原文链接：<https://blog.csdn.net/shn111/article/details/122465074>

依赖：别人写的库，依赖其进行编译

依赖管理的三个阶段：GOPATH，GOVENDOR，go mod

GOPATH和GOVENDOR正在向go mod迁移

一、GOPATH

GOPATH是一个环境，就是一个目录

默认在\~/go（unix，linux），%USERPROFILE%\\go（windows）

管理方式：给一个目录，所有的依赖都到GOPATH下去找

GOPATH要求在目录下必须有一个src目录，文件都放在\$GOPATH/src目录下

问题：所有的项目都在GOPATH目录下面，依赖库也放在GOPATH下面，导致GOPATH越来越大

注意：

1.在使用GOPATH和GOVENDOR管理依赖时GO111MODULE要设置为off

在终端输入命令：set GO111MODULE=off（Windows下）

2.在运行的时候在要进行如下设置，否则他还是会按照on来运行

![IMG_256](media/image30.png){width="5.35625in"
height="3.8368055555555554in"}

GO111MODULE=auto 在\$GOPATH/src 外面且根目录有go.mod
文件时，开启模块支持

GO111MODULE=off 无模块支持，go会从GOPATH 和 vendor 文件夹寻找包

GO111MODULE=on
模块支持，go会忽略GOPATH和vendor文件夹，只根据go.mod下载依赖

二、GOVENDOR

所有项目都放在一个path下它们所依赖的库会有冲突（如：不同项目依赖同一个库的不同版本）

每个项目都有自己的vendor目录，存放第三方库

GOVENDOR有大量第三方依赖管理工具：glide，dep，go dep

从下图可以看到对依赖会依次查找vendor、GOROOT和GOPATH目录

![IMG_256](media/image31.png){width="5.5159722222222225in"
height="3.6479166666666667in"}

三、go mod

项目会新建go.mod文件，依赖包到go.mod下找

以zap为例，main包如下

package main

import \"go.uber.org/zap\"

func main() {

logger, \_ := zap.NewProduction()

logger.Warn(\"warning test\")

}

go.mod如下

module awesomeProject1

go 1.17

require (

go.uber.org/atomic v1.10.0 // indirect

go.uber.org/multierr v1.8.0 // indirect

go.uber.org/zap v1.23.0 // indirect

)

zap.NewProduction()目录为：\$GOPATH/pkg/mod/go.uber.org/zap@1.23.0/logger.go

与项目不在同一目录下，由go命令统一的管理，用户不必关心目录结构

初始化：

go mod init

增加依赖：

使用go get命令拉取

在代码中直接import

更新依赖：

go get \[@v...\] (不加版本号默认为最新版本)，

go mod tidy(清除多余文件)

项目迁移到go mod：

go mod init

go build ./... （当前目录以及其所有子目录全部build一遍）

目录整理

一个目录下只能有一个main函数，如果目录下有多个main函数在go
build时会报错，因此在目录整理时，应该把各个main函数都分配到不同的目录下

## 1.19 [第一个Go语言程序](http://c.biancheng.net/view/6036.html)

通过前面学习大家已经对Go语言有了一定的了解，那要怎么来创建一个Go语言程序呢？本节就来带领大家实现一个简单的程序------在控制台输出"Hello
World!"。\
\
在控制台输出"Hello World!"非常简单，仅需要几行代码就可以搞定，如下所示：

1.  package main // 声明 main 包

2.  

3.  import (

4.  \"fmt\" // 导入 fmt 包，打印字符串是需要用到

5.  )

6.  

7.  func main() { // 声明 main 主函数

8.  fmt.Println(\"Hello World!\") // 打印 Hello World!

9.  }

大家也许不明白这些代码的含义，没关系，下面就来一一介绍。

#### package（创建包）

Go语言以"包"作为管理单位，每个 Go
源文件必须先声明它所属的包，所以我们会看到每个 Go 源文件的开头都是一个
package 声明，格式如下：

package name

其中 package 是声明包名的关键字，name 为包的名字。\
\
Go语言的包与文件夹是一一对应的，它具有以下几点特性：

-   一个目录下的同级文件属于同一个包。

-   包名可以与其目录名不同。

-   main 包是Go语言程序的入口包，一个Go语言程序必须有且仅有一个 main
    包。如果一个程序没有 main
    包，那么编译时将会出错，无法生成可执行文件。

#### import（导入包）

在包声明之后，是 import
语句，用于导入程序中所依赖的包，导入的包名使用双引号\"\"包围，格式如下：

import \"name\"

其中 import 是导入包的关键字，name 为所导入包的名字。\
\
代码第 4 行导入了 fmt 包，这行代码会告诉 Go 编译器，我们需要用到 fmt
包中的函数或者变量等，fmt
包是Go语言标准库为我们提供的，用于格式化输入输出的内容（类似于C语言中的
stdio.h 头文件），类似的还有 os 包、io 包等，后面我们会详细介绍。\
\
另外有一点需要注意，导入的包中不能含有代码中没有使用到的包，否则Go编译器会报编译错误，例如 imported
and not used: \"xxx\"，\"xxx\" 表示包名。\
\
也可以使用一个 import 关键字导入多个包，此时需要用括号(
)将包的名字包围起来，并且每个包名占用一行，也就是写成下面的样子：

import(\
    \"name1\"\
    \"name2\"\
)

#### main 函数

代码的第 7 行创建了一个 main
函数，它是Go语言程序的入口函数，也即程序启动后运行的第一个函数。main
函数只能声明在 main 包中，不能声明在其他包中，并且，一个 main
包中也必须有且仅有一个 main 函数。

C/C++ 程序的入口函数也是 main()，一个 C/C++ 程序有且只能有一个 main()
函数。

main 函数是自定义函数的一种，在Go语言中，所有函数都以关键字 func
开头的，定义格式如下所示：

func 函数名 (参数列表) (返回值列表){\
    函数体\
}

格式说明如下：

-   函数名：由字母、数字、下画线_组成，其中，函数名的第一个字母不能为数字，并且，在同一个包内，函数名称不能重名。

-   参数列表：一个参数由参数变量和参数类型组成，例如func foo( a int, b
    string )。

-   返回值列表：可以是返回值类型列表，也可以是参数列表那样变量名与类型的组合，函数有返回值时，必须在函数体中使用
    return 语句返回。

-   函数体：能够被重复调用的代码片段。

注意：Go语言函数的左大括号{必须和函数名称在同一行，否则会报错。

#### 打印 Hello World

代码的第 8 行fmt.Println(\"Hello World!\")中，Println 是 fmt
包中的一个函数，它用来格式化输出数据，比如字符串、整数、小数等，类似于C语言中的
printf 函数。这里我们使用 Println 函数来打印字符串，也就是(
)里面使用\"\"包裹的部分。

注意，Println 函数打印完成后会自动换行，ln是 line 的缩写。

点号.是Go语言运算符的一种，这里表示调用 fmt 包中的 Println 函数。\
\
另外，代码fmt.Println(\"Hello
World!\")的结尾，不需要使用;来作为结束符，Go
编译器会自动帮我们添加，当然，在这里加上;也是可以的。\
\
到这里，相信大家已经知道如何创建一个简单的Go语言程序了，赶快动手试试吧！下一节将为大家演示，如何运行我们所编写的Go语言程序。

## 1.20 [Go语言程序的编译和运行](http://c.biancheng.net/view/6046.html)

Go语言是编译型的静态语言（和C语言一样），所以在运行Go语言程序之前，先要将其编译成二进制的可执行文件。\
\
可以通过Go语言提供的go build或者go run命令对Go语言程序进行编译：

-   go
    build命令可以将Go语言程序代码编译成二进制的可执行文件，但是需要我们手动运行该二进制文件；

-   go
    run命令则更加方便，它会在编译后直接运行Go语言程序，编译过程中会产生一个临时文件，但不会生成可执行文件，这个特点很适合用来调试程序。

下面就来演示一下，如何运行我们上一节中编写的Go语言程序。\
\
因为之前我们已经配置好了环境变量，所以可以直接使用 Windows
自带的命令行工具（也叫 CMD
窗口或者命令提示符）来编译Go语言程序。微软后来对命令行工具进行了一次升级，并更名为
Powershell，power 是更加强大的意思。\
\
打开命令行工具的方式多种多样，下面列出了比较常用的两种：

-   可以在开始菜单中打开命令行工具，然后 cd 到 Go 源文件所在的目录。

-   也可以在 Go 源文件所在目录的空白处按住 Shift
    键并单击鼠标右键，然后在弹出菜单中选择"在此处打开命令行窗口"或者"在此处打开
    Powershell 窗口"，这样会自动 cd 到 Go
    源文件所在的目录，如下图所示。这种方式更加方便，推荐大家使用。

提示：cd 是命令行工具的一个命令，用来改变当前所在的目录，是 change
directory 的缩写。

![IMG_256](media/image32.png){width="5.161111111111111in"
height="3.9451388888888888in"}\
Win7 下选择"在此处打开命令窗口"\
\
![IMG_257](media/image33.png){width="3.5840277777777776in"
height="3.6638888888888888in"}\
Win10 下选择"在此处打开 Powershell 窗口"

### go build 命令

go
build命令用来启动编译，它可以将Go语言程序与相关依赖编译成一个可执行文件，其语法格式如下。

go build fileName

其中 fileName 为所需要的参数，可以是一个或者多个 Go
源文件名（当有多个参数时需要使用空格将两个相邻的参数隔开），也可以省略不写。\
\
使用 go build 命令进行编译时，不同参数的执行结果也是不同的。

#### 1) 当参数不为空时

如果 fileName 为同一 main
包下的所有源文件名（可能有一个或者多个），编译器将生成一个与第一个
fileName 同名的可执行文件（如执行go build abc.go def.go \...会生成一个
abc.exe 文件）；如果 fileName 为非 main
包下的源文件名，编译器将只对该包进行语法检查，不生成可执行文件。

#### 2) 当参数为空时

如果当前目录下存在 main
包，则会生成一个与当前目录名同名的"目录名.exe"可执行文件（如在 hello
目录中执行go build命令时，会生成 hello.exe 文件）；如果不存在 main
包，则只对当前目录下的程序源码进行语法检查，不会生成可执行文件。\
\
使用go build命令对我们上一节编写的程序进行编译，运行结果如下所示：

D:\\code\> go build .\\demo.go\
D:\\code\> .\\demo.exe\
Hello World!

其中D:\\code\>对应的是当前目录，也就是 D 盘下的 code
文件夹，它是命令行工具自动添加的，不属于编译命令的一部分。\
\
第 1 行go build命令后面的参数中，.\\表示当前目录。在Windows
系统中，当前目录使用.\\表示；在类 Unix 系统（例如 Linux、MacOS
等）中，当前目录使用./表示。

注意，这里的go build命令中.\\可以省略不写，不会影响编译。

另外，go
build命令只有在执行出错的情况下才会有返回信息，执行成功的话是没有返回信息的，但是会在当前目录生成一个与
main 包文件同名的 .exe 可执行文件，如下图所示。

![IMG_258](media/image34.png){width="5.583333333333333in"
height="2.4479166666666665in"}

第 2 行中的.\\demo.exe表示执行当前目录下的 demo.exe 程序。\
\
第 3 行则是 demo.exe 程序的运行结果。

### go run 命令

除了使用go build命令外，Go语言还为我们提供了go run命令，go
run命令将编译和执行指令合二为一，会在编译之后立即执行Go语言程序，但是不会生成可执行文件。\
\
go run命令的语法格式如下：

go run fileName

其中 fileName 为所需要的参数，参数必须是同一 main
包下的所有源文件名，并且不能为空。\
\
使用go run命令对我们上一节编写的程序进行编译，运行结果如下所示：

D:\\code\> go run demo.go\
Hello World!

可以看到第 1 行的go run命令执行后，直接在第 2 行输出了程序的运行结果。\
\
除了本节中所讲的，go build命令和go
run命令还有很多其他的编译方法，我们将在后面为大家详细介绍。

## 1.21 [Goland下载和安装](http://c.biancheng.net/view/6124.html)

### Goland 2019下载和安装（带破解补丁和汉化包）

工欲善其事必先利其器，命令行工具虽然能够满足我们一些基本操作的需求，但实际工作中怎么能没有一款趁手的开发工具呢？\
\
学习Go语言同样如此，一个强大的集成开发环境（IDE）能够大大提高我们的开发效率，目前市面上比较流行的有下面这几种：

-   GoLand：由 JetBrains 公司开发的一个新的商业 IDE；

-   LiteIDE X：一款简单、开源、跨平台的Go语言 IDE；

-   第三方插件：Sublime Text、VS Code 等编辑器都有Go语言的相关插件。

本节我们主要介绍 Windows 系统上 Goland 的安装和配置过程。

### Goland 简介

Goland 是由 JetBrains 公司开发的一个新的商业 IDE，旨在为 Go
开发者提供的一个符合人体工程学的新的商业 IDE。Goland 整合了 IntelliJ
平台（一个用于 java
语言开发的集成环境，也可用于其他开发语言），提供了针对Go语言的编码辅助和工具集成。

### Goland 下载和安装

大家可以从 Goland 的官网下载对应版本的 Goland
的安装包：（教程中使用的版本是 2019.2.3）

-   官网下载地址：https://www.jetbrains.com/go/download/other.html；

-   **（推荐）**直接复制本条链接到迅雷中下载：<https://download.jetbrains.com/go/goland-2019.2.3.exe>。

![IMG_256](media/image35.png){width="6.361805555555556in"
height="3.1777777777777776in"}\
Goland 官网的下载页面

下载完成后直接双击运行安装包。

![IMG_257](media/image36.png){width="4.427083333333333in"
height="2.201388888888889in"}\
运行下载好的安装包

首先看到的是一个欢迎页面，不用管它，直接点击 Next 就行。

![IMG_258](media/image37.png){width="4.449305555555555in"
height="3.2319444444444443in"}\
直接点击 Next 即可

自定义安装目录，默认是安装在 C
盘，大家可以自行选择合适的位置安装，选择好后点击 Next 进入下一步操作。

![IMG_259](media/image38.png){width="5.197916666666667in"
height="4.041666666666667in"}\
点击 Browse 即可修改安装目录

下面是一些安装选项，选项中的一些信息大家可以根据自己的需要勾选，确认无误后点击
Next。

![IMG_260](media/image39.png){width="5.177083333333333in"
height="3.7604166666666665in"}\
安装选项

在开始菜单中为 Goland
的快捷方式选择一个文件夹，这一步我们不需要修改，直接点击 Install。

![IMG_261](media/image40.png){width="5.177083333333333in"
height="3.7604166666666665in"}\
选择一个开始菜单中的文件夹

开始安装，等待安装完成即可。

![IMG_262](media/image41.png){width="5.177083333333333in"
height="3.7604166666666665in"}

安装完成，勾选 Run Goland 并点击 Finish，结束安装并启动 Goland。

![IMG_263](media/image42.png){width="5.197916666666667in"
height="4.041666666666667in"}\
结束安装，并启动Goland

### 运行 Goland 并激活

第一次启动 Goland
时会提示我们导入设置信息，这里我们选择第二项，不导入设置信息。

![IMG_264](media/image43.png){width="4.354166666666667in"
height="1.59375in"}\
导入设置信息

点击 OK 后发现需要激活，免费试用的话也仅有 30
天的时间，这就尴尬了！别急下面就来告诉大家怎么破解它。首先点击 Exit
关闭正在运行的 Goland 程序。

![IMG_265](media/image44.png){width="4.604166666666667in"
height="4.260416666666667in"}\
激活界面

然后，大家可以【[点击这里](http://c.biancheng.net/uploads/course/go/Goland_Crack_Sinicization.zip)】下载相关的破解补丁，如下所示：

![IMG_266](media/image45.png){width="5.072916666666667in"
height="2.4895833333333335in"}

将下载好的文件解压，并将破解补丁"jetbrains-agent.jar"复制到 Goland
安装目录下的 bin 目录中，放到这里没有什么特殊的意义，只是为了防止误删。

![IMG_267](media/image46.png){width="5.105555555555555in"
height="2.238888888888889in"}\
将破解补丁复制到 bin 目录

在 Goland 安装目录的 bin
目录下找到"goland.exe.vmoptions"和"goland64.exe.vmoptions"两个文件。用记事本将它们打开，并分别在两个文件的最后面追加"-javaagent:Goland
的安装目录\\bin\\jetbrains-agent.jar"，注意将路径修改成你电脑上 Goland
的安装目录，例如
"-javaagent:D:\\anzhuang\\GoLand\\bin\\jetbrains-agent.jar"，修改完成后记得保存。

![IMG_268](media/image47.png){width="5.64375in"
height="2.123611111111111in"}\
修改配置文件

运行 Goland 进入激活界面，选择"Activate"，激活方式选择"Activation
code"使用激活码激活，并将激活码粘贴到下面，点击 OK
即可。激活码可以在下载的破解补丁中找到。

![IMG_269](media/image48.png){width="5.196527777777778in"
height="2.4097222222222223in"}

复制激活码

到这里 Goland
已经成功激活了，在开始敲代码之前需要先创建一个项目，选择"New
Project"新建一个项目。

![IMG_270](media/image49.png){width="5.076388888888889in"
height="3.720138888888889in"}

选择一个目录作为项目的根目录，并选择合适的Go语言版本，点击"Create"完成创建。

![IMG_271](media/image50.png){width="5.102083333333334in"
height="3.738888888888889in"}\
创建新项目

项目创建完成，终于可以开始敲代码了。

![IMG_272](media/image51.png){width="5.127777777777778in"
height="3.1055555555555556in"}

### Goland 汉化

汉化在这里的意思是中文化，因为 Goland
的菜单都是英文的，这对于刚刚接触它的新手来说会造成一定的困扰，那要怎么实现中文呢？这里需要用到一些特殊的方法。\
\
首先关闭 Goland
，然后在我们下载的破解补丁中找到"resources_cn.jar"，并将它复制到 Goland
安装目录下的 lib 目录中，如下图所示：

![IMG_273](media/image52.png){width="5.7347222222222225in"
height="2.490972222222222in"}\
复制汉化补丁

然后，同样在 lib 目录中找到"resources_en.jar"文件，它是 Goland
内置的一个英文补丁，这里需要将它删除或者重命名，建议大家选择重命名的方式，因为想要恢复英文的话还需要用到它。

![IMG_274](media/image53.png){width="5.1819444444444445in"
height="2.251388888888889in"}\
重命名 resources_en.jar

运行 Goland ，你会发现 Goland 中的菜单已经变成我们熟悉的中文了。

![IMG_275](media/image54.png){width="5.572222222222222in"
height="3.375in"}

汉化后的效果

提示：汉化补丁并没有实现百分之百的汉化，仍然存在部分英文。

## 1.22 [Goland入门指南](http://c.biancheng.net/view/6170.html)（使用Goland创建并运行项目）

上一节详细介绍了 Goland 的安装和破解，本节我们来介绍一下怎么使用 Goland
来创建并运行一个项目。

## 创建项目

首先，在"文件"菜单中找到"New"，并在下一级菜单中选择"Project"来创建一个新项目。 

![IMG_256](media/image55.png){width="8.333333333333334in"
height="5.447916666666667in"}\
在菜单中选择新建项目

为项目选择一个目录（尽量选择空目录），并点击"Create"完成创建。

![IMG_257](media/image56.png){width="8.09375in"
height="4.791666666666667in"}

创建项目

## 编辑运行/调试配置

每次创建项目之后，我们都需要对 Goland 进行一些配置，在 Goland
的右上方找到"Add Configuration"并单击。

![IMG_258](media/image57.png){width="8.322916666666666in"
height="2.5729166666666665in"}\
点击 Add Configuration

在弹出的窗口中点击"+"，并在下拉菜单中选择"Go Build"。

![IMG_259](media/image58.png){width="6.34375in"
height="3.5833333333333335in"}\
编辑配置信息

点击"Go Build"之后，在窗口中填写对应的信息，如下所示。

![IMG_260](media/image59.png){width="7.291666666666667in"
height="5.34375in"}

上图中有以下几点需要注意：

-   名称：为本条配置信息的名称，可以自定义，也可以使用系统默认的值；

-   Run kind：这里需要设置为"Directory"；

-   Directory：用来设置 main 包所在的目录，不能为空；

-   Output
    directory：用来设置编译后生成的可执行文件的存放目录，可以为空，为空时默认不生成可执行文件；

-   Working
    directory：用来设置程序的运行目录，可以与"Directory"的设置相同，但是不能为空。

提示：除了上面提到的几点外，其余的配置项使用系统的默认值即可，无需修改。

## 编写并运行代码

将 Goland 配置好后，就可以在项目文件夹下编写代码了。首先新建一个 Go
源文件，在项目文件夹上点击右键，然后在弹出的菜单中找到"新建"，并在下一级菜单中选择"Go
File"，最后在弹出框中输入文件名（红框处）并选择"Empty
file"，无误后按"Enter"键进行确认。

![IMG_261](media/image60.png){width="8.322916666666666in"
height="5.03125in"}\
新建 Go 源文件

在新创建的 Go 源文件中写入如下代码。

![IMG_262](media/image61.png){width="8.322916666666666in"
height="3.0208333333333335in"}\
编写测试代码

然后，我们就可以点击 Goland 右上方的绿色三角来运行上面编写的程序了。

![IMG_263](media/image62.png){width="8.322916666666666in"
height="4.1875in"}\
运行程序

## 1.23 Goland常用快捷键

本节来介绍一下 Goland 中快捷键的设置以及一些常用的快捷键。

### Goland 快捷键设置

Goland 可以模拟各种编辑器的快捷键，例如 Eclipse、Sublime Text 等。\
\
大家可以在"文件"菜单中找到"设置"，然后在新弹出的窗口选择"快捷键"选项，就可以对快捷键进行编辑了，如下图所示。

![IMG_256](media/image63.png){width="8.322916666666666in"
height="5.03125in"}\
编辑快捷键

### Goland 常用快捷键

下面列举了一些 Goland 中经常使用到的快捷键。\
\
1) 文件操作相关的快捷键

  ---------------------- ------------------------------------------------
  **快捷键**             **作用**

  Ctrl + E               打开最近浏览过的文件

  Ctrl + N               快速打开某个 struct 结构体所在的文件

  Ctrl + Shift + N       快速打开文件

  Shift + F6             重命名文件夹、文件、方法、变量名等
  ---------------------- ------------------------------------------------

2\) 代码格式化相关的快捷键

  ------------- ------------------------------------------------------------------------
  **快捷键**    **作用**

  Ctrl + Alt +  格式化代码
  L             

  Ctrl + 空格   代码提示

  Ctrl + /      单行注释

  Ctrl +        多行注释
  Shift + /     

  Ctrl + B 或   快速跳转到结构体或方法的定义位置（需将光标移动到结构体或方法的名称上）
  F4            

  Ctrl +"+ 或   可以将当前（光标所在位置）的方法进行展开或折叠
  -"            
  ------------- ------------------------------------------------------------------------

3\) 查找和定位相关的快捷键

  ---------------------------------- ------------------------------------
  **快捷键**                         **作用**

  Ctrl + R                           替换文本

  Ctrl + F                           查找文本

  Ctrl + Shift + F                   全局查找

  Ctrl + G                           显示当前光标所在行的行号

  Ctrl + Shift + Alt + N             查找类中的方法或变量
  ---------------------------------- ------------------------------------

4\) 编辑代码相关的快捷键

  ------------------- -------------------------------------------------------------
  **快捷键**          **作用**

  Ctrl + J            快速生成一个代码片段

  Shift+Enter         向光标的下方插入一行，并将光标移动到该行的开始位置

  Ctrl + X            删除当前光标所在行

  Ctrl + D            复制当前光标所在行

  Ctrl + Shift +      将光标所在的行进行上下移动（也可以使用
  方向键上或下        Alt+Shift+方向键上或下）

  Alt + 回车          自动导入需要导入的包

  Ctrl + Shift + U    将选中的内容进行大小写转化

  Alt + Insert        生成测试代码

  Alt + Up/Down       快速移动到上一个或下一个方法

  Ctrl + Alt + Space  类名或接口名提示（代码提示）

  Ctrl + P            提示方法的参数类型（需在方法调用的位置使用，并将光标移动至(
                      )的内部或两侧）
  ------------------- -------------------------------------------------------------

5\) 编辑器相关的快捷键

  ---------------------------- ------------------------------------------
  **快捷键**                   **作用**

  Ctrl + Alt + left/right      返回至上次浏览的位置

  Alt + left/right             切换代码视图

  Ctrl + W                     快速选中代码

  Alt + F3                     逐个向下查找选中的代码，并高亮显示

  Tab                          代码标签输入完成后，按 Tab，生成代码

  F2 或 Shift + F2             快速定位错误或警告

  Alt + Shift + C              查看最近的操作

  Alt + 1                      快速打开或隐藏工程面板
  ---------------------------- ------------------------------------------

## 1.24 LiteIDE搭建Go语言开发环境

LiteIDE
是一款专为Go语言开发而设计的开源、跨平台、轻量级集成开发环境（IDE），基于 Qt 开发（一个跨平台的 C++ 框架），支持
Windows、Linux 和 Mac OS X 平台。LiteIDE 的第一个版本发布于 2011 年 1
月初，是最早的面向Go语言的 IDE 之一。至今为止，LiteIDE 已经发布到版本
X36。

### 下载 LiteIDE

大家可以通过下面三种方式来下载 LiteIDE 安装包：

-   开源软件平台：https://sourceforge.net/projects/liteide/files/；

-   GitHub：https://github.com/visualfc/liteide/releases；

-   百度网盘：https://pan.baidu.com/s/1wYHSEfG1TJRC2iOkE_saJg（密码：jzrc）。

本节我们需要下载 Windows 版本的 LiteIDE 安装包。

![IMG_256](media/image64.png){width="8.333333333333334in"
height="4.854166666666667in"}\
下载 LiteIDE

因为 LiteIDE 是绿色版的，无需安装，所以下载完成后，得到的是一个 ZIP
格式的压缩文件。

![IMG_257](media/image65.png){width="5.489583333333333in"
height="2.3020833333333335in"}\
LiteIDE 的压缩文件

将压缩包解压到任意目录，这里我们将压缩包解压到了 D
盘，解压后会得到一个名为"liteide"的文件夹。

![IMG_258](media/image66.png){width="5.989583333333333in"
height="2.4583333333333335in"}\
解压 LiteIDE

进入 LiteIDE 文件夹中的 bin 文件夹，可以在 bin
文件夹中找到名为"liteide.exe"的文件，它就是 LiteIDE 的启动程序。

![IMG_259](media/image67.png){width="6.375in"
height="2.8645833333333335in"}\
LiteIDE 启动程序

双击运行"liteide.exe"就可以正常打开 LiteIDE
了，为了方便以后的使用，建议大家在桌面创建 LiteIDE
的快捷方式（在"liteide.exe"上右键→"发送到"→"桌面快捷方式"）。

![IMG_260](media/image68.png){width="8.302083333333334in"
height="5.59375in"}\
LiteIDE 起始页

### 配置 LiteIDE

修改当前的运行环境，需要根据系统的不同设置对应的运行环境，因为我们使用的是
64 位的 Windows 系统，所以这里需要将运行环境设置为 Win64 。

![IMG_261](media/image69.png){width="8.302083333333334in"
height="4.145833333333333in"}\
修改当前运行环境

配置当前运行环境，点击"工具"，在下拉菜单中选择"编辑当前环境"，如下图所示。

![IMG_262](media/image70.png){width="8.302083333333334in"
height="4.145833333333333in"}\
编辑当前环境

在打开的文件中找到"GOROOT=xxx"，并将其修改为环境变量中 GOROOT
对应的值，如下所示。（注意：修改完成后记得保存）

![IMG_263](media/image71.png){width="8.302083333333334in"
height="4.802083333333333in"}\
编辑Go语言开发包的安装目录

如果记不清了也没关系，可以在 CMD 窗口中使用go env命令查看 GOROOT
对应的值。

![IMG_264](media/image72.png){width="7.489583333333333in"
height="5.03125in"}\
使用go env命令查看Go语言开发包的相关信息

添加自定义 GOPATH，在"工具"菜单中找到"管理
GOPATH/Modules\..."，如下图所示。（注意：因为系统中已经包含了一个默认的
GOPATH，所以此步骤不是必须的，了解即可）

![IMG_265](media/image73.png){width="8.302083333333334in"
height="4.802083333333333in"}\
管理 GOPATH

在弹出的窗口中找到"使用自定义
GOPATH"，将其勾选，然后点击"添加目录"，选择合适的目录即可。

![IMG_266](media/image74.png){width="8.333333333333334in"
height="3.3020833333333335in"}\
添加自定义 GOPATH

### 新建项目

到这里 LiteIDE
已经基本上配置完成了，下面我们就来创建一个项目来测试一下。\
\
首先，在"文件"菜单中选择"新建"，在弹出的窗口中，选择系统默认的 GOPATH
路径，模板选择"Go1 Command
Project"，最后填写项目名称，并选择合适的目录，确认无误后点击"OK"。

![IMG_267](media/image75.png){width="5.2659722222222225in"
height="3.046527777777778in"}\
新建项目

新建好的项目是下面这样的，编辑器自动为我们创建了两个文件，并在"main.go"中生成了简单的代码。

![IMG_268](media/image76.png){width="5.5472222222222225in"
height="3.2083333333333335in"}\
新建完成的项目

点击编辑器右上方的"BR"按钮，就可以运行"main.go"中的代码，同时会在当前目录下生成一个
.exe 的可执行文件。

![IMG_269](media/image77.png){width="5.438194444444444in"
height="3.2888888888888888in"}\
运行程序
